import{r as c,j as e,X as us,P as js,T as N,V as Ae,W as gs,S as ps,Y as Ns,N as fs,Z as vs,U as bs,_ as ys,a0 as Cs,O as ws,D as Ss,a1 as ks,a2 as Es,I as Ts,a3 as Ds}from"./vendor-CvKrFYBg.js";import{N as oe,C as b,a as y,b as C,c as k,d as ce}from"./card-Cjxxdy58.js";import{F as Is}from"./footer-CP3_GpQF.js";import{B as x}from"./button-PXHQ3is1.js";import{I as l}from"./input-BXXAQ33C.js";import{L as n,S as $,a as H,b as _,c as G,d as w}from"./select-DvnaZnQZ.js";import{c as E,a as As,u as Fs}from"./index-cgtXp0BU.js";import{k as Ls,m as Rs,n as J,F as zs,p as Fe}from"./firebase-S-KbnFMc.js";import{O as Re,f as ze,g as Ms,h as Me,i as Ve,j as Vs,k as Bs}from"./radix-B4AvY2xt.js";const Le=Vs,Ps=Bs,Be=c.forwardRef(({className:g,...p},f)=>e.jsx(Re,{ref:f,className:E("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",g),...p}));Be.displayName=Re.displayName;const de=c.forwardRef(({className:g,children:p,...f},m)=>e.jsxs(Ps,{children:[e.jsx(Be,{}),e.jsxs(ze,{ref:m,className:E("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",g),...f,children:[p,e.jsxs(Ms,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));de.displayName=ze.displayName;const me=({className:g,...p})=>e.jsx("div",{className:E("flex flex-col space-y-1.5 text-center sm:text-left",g),...p});me.displayName="DialogHeader";const xe=({className:g,...p})=>e.jsx("div",{className:E("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",g),...p});xe.displayName="DialogFooter";const he=c.forwardRef(({className:g,...p},f)=>e.jsx(Me,{ref:f,className:E("text-lg font-semibold leading-none tracking-tight",g),...p}));he.displayName=Me.displayName;const ue=c.forwardRef(({className:g,...p},f)=>e.jsx(Ve,{ref:f,className:E("text-sm text-muted-foreground",g),...p}));ue.displayName=Ve.displayName;const Us=js({nombre:N().trim().min(1,"El nombre es obligatorio"),dni:N().trim().regex(/^\d{13}$/,"El DNI debe tener 13 dígitos sin guiones"),nacimiento:N().min(1,"La fecha de nacimiento es obligatoria"),email:N().trim().email("Correo inválido"),telefono:N().trim().min(7,"Teléfono inválido"),club:N().trim().optional(),distancia:Ae(["800m","2km","5km"]),sexo:Ae(["M","F"]),emergenciaNombre:N().trim().optional(),emergenciaTel:N().trim().optional(),medico:N().trim().optional(),banco:N().trim().min(1,"El banco es obligatorio"),monto:N().trim().min(1,"El monto es obligatorio"),referencia:N().trim().min(1,"La referencia es obligatoria"),tallaCamisa:N().trim().optional()}),Qs=()=>{const g=["NT","NS","DNS","DNF"],p=["12","14","16","XS","S","M","L","XL","XXL"],f=new Date("2025-10-12"),{toast:m}=As(),{registrations:R,stats:v,updateRegistrationStatus:Pe,toggleCheckIn:Ue,updateRegistrationResult:je,updateRegistrationData:Oe,addRegistration:qe,isLoading:$e,error:ge}=Fs(),X=c.useMemo(()=>"gustavomartinezh87@gmail.com,admin@losnaranjos.com".split(",").map(s=>s.trim().toLowerCase()).filter(Boolean),[]),pe="".trim(),[T,Ne]=c.useState({email:"",password:""}),[fe,Y]=c.useState(null),[D,I]=c.useState(null),[A,z]=c.useState(null),[He,ve]=c.useState(!0),[be,ye]=c.useState(!1),[Q,_e]=c.useState(""),[M,Ge]=c.useState(""),[V,Je]=c.useState(""),[B,Xe]=c.useState(""),[W,Ce]=c.useState({}),[Ye,we]=c.useState({}),[Qe,Z]=c.useState(!1),[S,Se]=c.useState(null),[h,K]=c.useState({}),[ke,P]=c.useState(""),[Ee,U]=c.useState(""),[ee,se]=c.useState(!1),[We,F]=c.useState(!1),[ae,Te]=c.useState(!1),[De,O]=c.useState(""),te=typeof v.max=="number"&&Number.isFinite(v.max)&&v.max>0,Ze=te&&typeof v.remaining=="number"?v.remaining:"Sin límite",Ke=te?"Cupos Restantes":"Cupos disponibles",es=te?`Usa este formulario para agregar participantes adicionales (hasta ${v.max} en total). Los campos obligatorios están marcados con *.`:"Usa este formulario para agregar participantes adicionales. No hay límite de cupos. Los campos obligatorios están marcados con *.",r=gs({resolver:Ds(Us),defaultValues:{nombre:"",dni:"",nacimiento:"",email:"",telefono:"",club:"",distancia:"800m",sexo:"M",emergenciaNombre:"",emergenciaTel:"",medico:"",banco:"BAC Honduras",monto:"300",referencia:"",tallaCamisa:""}}),ss=s=>{if(!s)return null;const a=new Date(s);if(Number.isNaN(a.getTime()))return null;let t=f.getFullYear()-a.getFullYear();return f.getMonth()>a.getMonth()||f.getMonth()===a.getMonth()&&f.getDate()>=a.getDate()||(t-=1),t},re=(s,a)=>{if(!s||!a)return"";const t=ss(s);return t===null?"":a==="800m"?t>=9&&t<=10?"Infantiles A (9-10)":t>=11&&t<=12?"Infantiles B (11-12)":t>=13&&t<=14?"Juveniles A (13-14)":t>=15?"Masters":"":t>=15&&t<=17?"Juveniles B (15-17)":t>=18&&t<=30?"20-30":t>=31&&t<=40?"30-40":"40+"},as=async s=>{s.preventDefault(),ye(!0),Y(null);try{const a=T.email.trim().toLowerCase();if(!X.includes(a))throw new Error("Este correo no está autorizado para acceder al panel.");if(pe&&T.password===pe){I(null),z({email:a}),ve(!1),m({title:"Acceso autorizado",description:"Sesión iniciada en modo local"});return}await Rs(J,a,T.password),m({title:"Acceso autorizado",description:"Bienvenido al panel de administración"})}catch(a){let t="No se pudo autenticar. Intenta nuevamente.";if(a instanceof zs)switch(a.code){case"auth/invalid-credential":case"auth/wrong-password":t="Contraseña incorrecta.";break;case"auth/user-not-found":t="No existe un usuario con ese correo.";break;case"auth/too-many-requests":t="Demasiados intentos. Espera unos minutos antes de volver a intentar.";break;default:t=a.message}else a instanceof Error&&(t=a.message);Y(t),m({variant:"destructive",title:"Error",description:t})}finally{ye(!1)}};c.useEffect(()=>{const s=Ls(J,async a=>{var t;if(Y(null),a){const o=((t=a.email)==null?void 0:t.toLowerCase())??"";X.includes(o)?(I(a),z(null)):(await Fe(J),I(null),z(null),m({variant:"destructive",title:"Acceso denegado",description:"Tu cuenta no tiene permiso para acceder al panel de administración."}))}else I(null);ve(!1)});return()=>s()},[X,m]);const L=(D==null?void 0:D.email)??(A==null?void 0:A.email)??"",ts=async()=>{try{D&&await Fe(J),z(null),I(null),m({title:"Sesión cerrada",description:"Has salido del panel de administración."})}catch{m({variant:"destructive",title:"Error",description:"No se pudo cerrar la sesión. Intenta nuevamente."})}},Ie=c.useMemo(()=>{const s=Q.trim().toLowerCase();return R.filter(a=>{const t=!s||[a.nombre,a.dni,a.email,a.telefono,a.referencia,a.dorsal].map(i=>String(i||"").toLowerCase()).some(i=>i.includes(s)),o=!M||a.status===M,d=!V||a.distancia===V,u=!B||a.categoria===B;return t&&o&&d&&u}).sort((a,t)=>{const o=parseInt(a.dorsal??"0",10),d=parseInt(t.dorsal??"0",10);return Number.isFinite(o)&&Number.isFinite(d)&&o!==d?o-d:new Date(a.createdAt).getTime()-new Date(t.createdAt).getTime()})},[R,Q,M,V,B]),ne=s=>{const a=new Date(s);return Number.isNaN(a.getTime())?s:a.toLocaleString("es-HN",{dateStyle:"medium",timeStyle:"short"})},rs=s=>s.id in W?W[s.id]:s.resultTime??"",ns=(s,a)=>{Ce(t=>({...t,[s]:a}))},is=async s=>{const t=(W[s.id]??s.resultTime??"").trim(),o=t?g.includes(t.toUpperCase())?t.toUpperCase():t:"";we(d=>({...d,[s.id]:!0}));try{await je(s.id,o||null,L||"admin"),Ce(d=>({...d,[s.id]:o})),m({title:"Resultado actualizado",description:o?`Tiempo guardado: ${o}`:"Resultado eliminado"})}catch(d){const u=d instanceof Error?d.message:"No se pudo guardar el resultado.";m({variant:"destructive",title:"Error al guardar",description:u})}finally{we(d=>({...d,[s.id]:!1}))}},ie=async(s,a)=>{const t={validated:{title:"Inscripción validada",description:"El participante aparece ahora como validado en el panel."},rejected:{title:"Inscripción rechazada",description:"Recuerda comunicar al participante el motivo del rechazo."},pending:{title:"Inscripción pendiente",description:"El registro volvió al estado pendiente para revisión."}};try{await Pe(s,a,L||"admin",a==="pending"?{checkedInAt:null,checkedInBy:null}:{}),m(t[a])}catch(o){console.error("Error al actualizar estado",o),m({variant:"destructive",title:"Error",description:"No se pudo actualizar el estado. Intenta nuevamente."})}},ls=s=>{m({title:s.nombre,description:`DNI: ${s.dni} | Email: ${s.email} | Tel: ${s.telefono||"No indicado"} | Talla: ${s.tallaCamisa||"No indicada"} | Comprobante: ${s.comprobanteNombre??"No adjuntado"}`})},os=s=>{if(!s.comprobanteUrl){m({variant:"destructive",title:"Sin comprobante",description:"Este registro no tiene un comprobante adjunto."});return}window.open(s.comprobanteUrl,"_blank","noopener,noreferrer")},cs=async s=>{try{const a=!s.checkedInAt;await Ue(s.id,a,L||"admin@losnaranjos.com"),m({title:a?"Check-in registrado":"Check-in revertido",description:a?`El participante ${s.nombre} quedó marcado como presente.`:`El check-in de ${s.nombre} fue revertido.`})}catch(a){console.error("Error al registrar check-in",a),m({variant:"destructive",title:"Error",description:"No se pudo registrar el check-in. Intenta nuevamente."})}},ds=s=>{Se(s);const a={nombre:s.nombre,dni:s.dni,dorsal:s.dorsal,nacimiento:s.nacimiento,email:s.email,telefono:s.telefono,club:s.club,distancia:s.distancia||"800m",sexo:s.sexo||"M",categoria:s.categoria,emergenciaNombre:s.emergenciaNombre,emergenciaTel:s.emergenciaTel,medico:s.medico,banco:s.banco,monto:s.monto,referencia:s.referencia,tallaCamisa:s.tallaCamisa};a.distancia||(a.distancia="800m"),a.categoria=re(a.nacimiento??"",a.distancia??""),K(a),P(s.resultTime??""),U(""),Z(!0)},le=()=>{Z(!1),Se(null),K({}),P(""),U(""),se(!1)},j=(s,a)=>{K(t=>{const o={...t,[s]:a};if(s==="nacimiento"||s==="distancia"){const d=s==="nacimiento"?a:o.nacimiento??"",u=s==="distancia"?a:o.distancia??"";o.categoria=re(d??"",u??"")}return o})},ms=async()=>{if(S){se(!0),U("");try{await Oe(S.id,h,L||"admin");const s=ke.trim(),a=S.resultTime??"";if(s!==a.trim()){let o=null;if(s){const d=s.toUpperCase();if(g.includes(d))o=d;else{const u=s.split(":").map(i=>i.trim());if(u.some(i=>i===""||Number.isNaN(Number(i))))throw new Error("Formato de tiempo inválido. Usa mm:ss, hh:mm:ss o los códigos NT/NS.");if(u.length!==2&&u.length!==3)throw new Error("Formato de tiempo inválido. Usa mm:ss o hh:mm:ss.");o=s}}await je(S.id,o,L||"admin")}m({title:"Datos actualizados",description:"La inscripción se actualizó correctamente."}),le()}catch(s){const a=s instanceof Error?s.message:"No se pudo actualizar la inscripción.";U(a),m({variant:"destructive",title:"Error al editar",description:a})}finally{se(!1)}}},xs=r.handleSubmit(async s=>{var a,t,o,d,u;Te(!0),O("");try{const i=re(s.nacimiento,s.distancia);if(!i)throw new Error("La fecha de nacimiento no es válida para la distancia seleccionada.");await qe({nombre:s.nombre.trim(),dni:s.dni.trim(),nacimiento:s.nacimiento,email:s.email.trim(),telefono:s.telefono.trim(),club:((a=s.club)==null?void 0:a.trim())??"",distancia:s.distancia,sexo:s.sexo,categoria:i,emergenciaNombre:((t=s.emergenciaNombre)==null?void 0:t.trim())??"",emergenciaTel:((o=s.emergenciaTel)==null?void 0:o.trim())??"",medico:((d=s.medico)==null?void 0:d.trim())??"",banco:s.banco.trim(),monto:s.monto.trim(),referencia:s.referencia.trim(),tallaCamisa:((u=s.tallaCamisa)==null?void 0:u.trim())??"",comprobanteFile:null}),m({title:"Inscripción creada",description:"El participante fue agregado manualmente."}),r.reset(),F(!1)}catch(i){const q=i instanceof Error?i.message:"No se pudo crear la inscripción.";O(q),m({variant:"destructive",title:"Error al crear inscripción",description:q})}finally{Te(!1)}}),hs=()=>{if(!R.length){m({title:"Sin datos",description:"Aún no hay inscripciones para exportar."});return}const s=["Dorsal","Nombre","DNI","Email","Teléfono","Distancia","Categoría","Talla","Banco","Monto","Referencia","Estado","Check-in","Check-in por","Fecha registro","URL comprobante"],a=R.map(i=>[i.dorsal,i.nombre,i.dni,i.email,i.telefono,i.distancia,i.categoria,i.tallaCamisa,i.banco,i.monto,i.referencia,i.status,i.checkedInAt?i.checkedInAt:"",i.checkedInBy??"",i.createdAt,i.comprobanteUrl??""]),t=[s,...a].map(i=>i.map(q=>`"${String(q??"").replace(/"/g,'""')}"`).join(",")).join(`
`),o=new Blob([t],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(o),u=document.createElement("a");u.href=d,u.download=`inscripciones-${new Date().toISOString()}.csv`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(d),m({title:"Exportación lista",description:"El archivo CSV se descargó correctamente."})};return He&&!A?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(oe,{}),e.jsx("div",{className:"flex items-center justify-center px-4 py-32",children:e.jsx(b,{className:"card-gradient shadow-card max-w-sm w-full",children:e.jsxs(y,{className:"text-center",children:[e.jsx(C,{className:"text-xl",children:"Cargando autenticación..."}),e.jsx(k,{children:"Por favor espera un momento."})]})})})]}):!D&&!A?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(oe,{}),e.jsx("div",{className:"max-w-md mx-auto px-4 py-16",children:e.jsxs(b,{className:"card-gradient shadow-card",children:[e.jsxs(y,{className:"text-center",children:[e.jsx(ps,{className:"h-16 w-16 text-primary mx-auto mb-4"}),e.jsx(C,{className:"text-2xl",children:"Acceso Restringido"}),e.jsx(k,{children:"Panel de administración del Encuentro de Aguas Abiertas Los Naranjos"})]}),e.jsxs(ce,{children:[e.jsxs("form",{onSubmit:as,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"email",children:"Email"}),e.jsx(l,{id:"email",type:"email",value:T.email,onChange:s=>Ne(a=>({...a,email:s.target.value})),required:!0,placeholder:"admin@losnaranjos.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"password",children:"Contraseña"}),e.jsx(l,{id:"password",type:"password",value:T.password,onChange:s=>Ne(a=>({...a,password:s.target.value})),required:!0,placeholder:"••••••••"})]}),e.jsx(x,{type:"submit",className:"w-full button-gradient shadow-button",disabled:be,children:be?e.jsx(e.Fragment,{children:"Verificando..."}):e.jsxs(e.Fragment,{children:[e.jsx(Ns,{className:"mr-2 h-4 w-4"}),"Iniciar Sesión"]})}),fe&&e.jsx("p",{className:"text-sm text-destructive text-center",children:fe})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:e.jsx("p",{children:"Ingresa con una cuenta autorizada."})})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(oe,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Panel de Administración"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión de inscripciones - Los Naranjos 2025"})]}),e.jsx(x,{variant:"outline",onClick:ts,children:"Cerrar Sesión"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-6 mb-8",children:[e.jsx(b,{className:"card-gradient shadow-card",children:e.jsxs(y,{className:"text-center pb-3",children:[e.jsx(C,{className:"text-2xl text-primary",children:v.total}),e.jsx(k,{children:"Total Inscritos"})]})}),e.jsx(b,{className:"card-gradient shadow-card",children:e.jsxs(y,{className:"text-center pb-3",children:[e.jsx(C,{className:"text-2xl text-warm-accent",children:v.pending}),e.jsx(k,{children:"Pendientes"})]})}),e.jsx(b,{className:"card-gradient shadow-card",children:e.jsxs(y,{className:"text-center pb-3",children:[e.jsx(C,{className:"text-2xl text-lake-green",children:v.validated}),e.jsx(k,{children:"Validados"})]})}),e.jsx(b,{className:"card-gradient shadow-card",children:e.jsxs(y,{className:"text-center pb-3",children:[e.jsx(C,{className:"text-2xl text-secondary",children:v.checkedIn}),e.jsx(k,{children:"Check-in"})]})}),e.jsx(b,{className:"card-gradient shadow-card",children:e.jsxs(y,{className:"text-center pb-3",children:[e.jsx(C,{className:"text-2xl text-destructive",children:v.rejected}),e.jsx(k,{children:"Rechazados"})]})}),e.jsx(b,{className:"card-gradient shadow-card",children:e.jsxs(y,{className:"text-center pb-3",children:[e.jsx(C,{className:"text-2xl text-primary",children:Ze}),e.jsx(k,{children:Ke})]})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-8",children:[e.jsxs(x,{className:"button-gradient shadow-button",onClick:hs,children:[e.jsx(fs,{className:"mr-2 h-4 w-4"}),"Exportar CSV"]}),e.jsxs(x,{variant:"outline",children:[e.jsx(vs,{className:"mr-2 h-4 w-4"}),"Lector QR"]}),e.jsxs(x,{variant:"outline",children:[e.jsx(bs,{className:"mr-2 h-4 w-4"}),"Check-in"]}),e.jsxs(x,{className:"button-gradient shadow-button",onClick:()=>F(!0),children:[e.jsx(ys,{className:"mr-2 h-4 w-4"}),"Nueva inscripción"]})]}),e.jsxs(b,{className:"card-gradient shadow-card mb-8",children:[e.jsx(y,{children:e.jsx(C,{className:"text-xl text-primary",children:"Filtros y Búsqueda"})}),e.jsxs(ce,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(Cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(l,{className:"pl-10",placeholder:"DNI, nombre, referencia...",value:Q,onChange:s=>_e(s.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Estado"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-md bg-background",value:M,onChange:s=>Ge(s.target.value),children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pending",children:"Pendientes"}),e.jsx("option",{value:"validated",children:"Validados"}),e.jsx("option",{value:"rejected",children:"Rechazados"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Distancia"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-md bg-background",value:V,onChange:s=>Je(s.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),e.jsx("option",{value:"800m",children:"800m"}),e.jsx("option",{value:"2km",children:"2km"}),e.jsx("option",{value:"5km",children:"5km"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Categoría"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-md bg-background",value:B,onChange:s=>Xe(s.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),e.jsx("option",{value:"Infantiles A (9-10)",children:"Infantiles A (9-10)"}),e.jsx("option",{value:"Infantiles B (11-12)",children:"Infantiles B (11-12)"}),e.jsx("option",{value:"Juveniles A (13-14)",children:"Juveniles A (13-14)"}),e.jsx("option",{value:"Juveniles B (15-17)",children:"Juveniles B (15-17)"}),e.jsx("option",{value:"20-30",children:"20-30"}),e.jsx("option",{value:"30-40",children:"30-40"}),e.jsx("option",{value:"40+",children:"40+"}),e.jsx("option",{value:"Masters",children:"Masters"})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Registra tiempos en formato ",e.jsx("strong",{children:"mm:ss"})," o ",e.jsx("strong",{children:"hh:mm:ss"}),". También puedes usar los códigos",e.jsx("strong",{children:" NT"})," (No Time) y ",e.jsx("strong",{children:"NS"})," (No Show) cuando corresponda."]})]})]}),e.jsxs(b,{className:"card-gradient shadow-card",children:[e.jsx(y,{children:e.jsx(C,{className:"text-xl text-primary",children:"Inscripciones"})}),e.jsx(ce,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm md:text-base",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"text-left py-4 px-3",children:"Fecha"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Dorsal"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Nombre"}),e.jsx("th",{className:"text-left py-4 px-3",children:"DNI"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Distancia"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Categoría"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Tiempo"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Talla"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Banco"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Monto"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Referencia"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Check-in"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Estado"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Acciones"})]})}),e.jsx("tbody",{children:$e?e.jsx("tr",{children:e.jsx("td",{className:"py-6 text-center text-muted-foreground",colSpan:14,children:"Cargando inscripciones..."})}):ge?e.jsx("tr",{children:e.jsx("td",{className:"py-6 text-center text-destructive",colSpan:14,children:ge})}):Ie.length===0?e.jsx("tr",{children:e.jsx("td",{className:"py-6 text-center text-muted-foreground",colSpan:14,children:"No hay inscripciones que coincidan con los filtros seleccionados."})}):Ie.map(s=>e.jsxs("tr",{className:"border-b border-border hover:bg-muted/30",children:[e.jsx("td",{className:"py-4 px-3",children:ne(s.createdAt)}),e.jsxs("td",{className:"py-4 px-3 font-mono whitespace-nowrap",children:["#",s.dorsal]}),e.jsx("td",{className:"py-4 px-3 font-medium whitespace-normal",children:s.nombre}),e.jsx("td",{className:"py-4 px-3 font-mono text-xs md:text-sm whitespace-nowrap",children:s.dni}),e.jsx("td",{className:"py-4 px-3",children:s.distancia}),e.jsx("td",{className:"py-4 px-3",children:s.categoria||"N/A"}),e.jsx("td",{className:"py-4 px-3 min-w-[220px]",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{value:rs(s),onChange:a=>ns(s.id,a.target.value),placeholder:"mm:ss o NT/NS",className:"h-9"}),e.jsxs(x,{type:"button",size:"sm",className:"flex items-center gap-1",disabled:Ye[s.id],onClick:()=>is(s),children:[e.jsx(ws,{className:"h-4 w-4"}),"Guardar"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[s.resultTime?e.jsxs("span",{className:"flex items-center gap-1 text-primary",children:[e.jsx(Ss,{className:"h-3 w-3"}),s.resultTime]}):e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ks,{className:"h-3 w-3"}),"Pendiente"]}),s.resultRecordedAt&&e.jsxs("span",{children:["· ",new Date(s.resultRecordedAt).toLocaleString("es-HN")]})]})]})}),e.jsx("td",{className:"py-4 px-3",children:s.tallaCamisa||"N/A"}),e.jsx("td",{className:"py-4 px-3",children:s.banco||"N/A"}),e.jsx("td",{className:"py-4 px-3",children:s.monto?`L ${s.monto}`:"N/A"}),e.jsx("td",{className:"py-4 px-3 font-mono text-xs md:text-sm whitespace-nowrap",children:s.referencia||"N/A"}),e.jsx("td",{className:"py-4 px-3",children:s.checkedInAt?ne(s.checkedInAt):"Pendiente"}),e.jsx("td",{className:"py-4 px-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="validated"?"bg-lake-green/20 text-lake-green":s.status==="pending"?"bg-warm-accent/20 text-warm-accent":"bg-destructive/20 text-destructive"}`,children:s.status==="validated"?"Validado":s.status==="pending"?"Pendiente":"Rechazado"})}),e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>ls(s),children:"Ver"}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>os(s),disabled:!s.comprobanteUrl,children:"Comprobante"}),e.jsxs(x,{size:"sm",variant:"outline",className:"gap-1",onClick:()=>ds(s),children:[e.jsx(Es,{className:"h-3.5 w-3.5"}),"Editar"]}),e.jsx(x,{size:"sm",variant:"outline",className:s.checkedInAt?"bg-lake-green/10 text-lake-green":"",onClick:()=>cs(s),disabled:s.status==="rejected"||s.status==="pending"&&!s.checkedInAt,children:s.checkedInAt?"Revertir":"Check-in"}),s.status==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(x,{size:"sm",variant:"outline",className:"text-lake-green",onClick:()=>ie(s.id,"validated"),children:"✓"}),e.jsx(x,{size:"sm",variant:"outline",className:"text-destructive",onClick:()=>ie(s.id,"rejected"),children:"✗"})]}):e.jsx(x,{size:"sm",variant:"outline",onClick:()=>ie(s.id,"pending"),children:"Pend."})]})})]},s.id))})]})})})]}),e.jsx(Le,{open:Qe,onOpenChange:s=>s?Z(!0):le(),children:e.jsxs(de,{className:"max-w-3xl",children:[e.jsxs(me,{children:[e.jsx(he,{children:"Editar inscripción"}),e.jsx(ue,{children:"Ajusta los datos del participante para corregir información suministrada por error."})]}),S&&e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Nombre completo"}),e.jsx(l,{value:h.nombre??"",onChange:s=>j("nombre",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"DNI (13 dígitos)"}),e.jsx(l,{value:h.dni??"",onChange:s=>j("dni",s.target.value.replace(/\D/g,"").slice(0,13)),maxLength:13,inputMode:"numeric",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Dorsal"}),e.jsx(l,{value:h.dorsal??"",onChange:s=>j("dorsal",s.target.value.replace(/\D/g,"").slice(0,3)),maxLength:3,inputMode:"numeric",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Fecha de nacimiento"}),e.jsx(l,{type:"date",value:h.nacimiento??"",onChange:s=>j("nacimiento",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Email"}),e.jsx(l,{type:"email",value:h.email??"",onChange:s=>j("email",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Teléfono"}),e.jsx(l,{value:h.telefono??"",onChange:s=>j("telefono",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Club / Equipo"}),e.jsx(l,{value:h.club??"",onChange:s=>j("club",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Distancia"}),e.jsxs($,{value:h.distancia??"800m",onValueChange:s=>j("distancia",s),children:[e.jsx(H,{children:e.jsx(_,{placeholder:"Selecciona distancia"})}),e.jsxs(G,{children:[e.jsx(w,{value:"800m",children:"800 metros"}),e.jsx(w,{value:"2km",children:"2 kilómetros"}),e.jsx(w,{value:"5km",children:"5 kilómetros"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Sexo"}),e.jsxs($,{value:h.sexo??"M",onValueChange:s=>j("sexo",s),children:[e.jsx(H,{children:e.jsx(_,{placeholder:"Selecciona sexo"})}),e.jsxs(G,{children:[e.jsx(w,{value:"F",children:"Femenino"}),e.jsx(w,{value:"M",children:"Masculino"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Categoría asignada"}),e.jsx(l,{value:h.categoria??"",readOnly:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Talla de camisa"}),e.jsx(l,{value:h.tallaCamisa??"",onChange:s=>j("tallaCamisa",s.target.value),list:"shirt-sizes"}),e.jsx("datalist",{id:"shirt-sizes",children:p.map(s=>e.jsx("option",{value:s},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Contacto de emergencia"}),e.jsx(l,{value:h.emergenciaNombre??"",onChange:s=>j("emergenciaNombre",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Teléfono de emergencia"}),e.jsx(l,{value:h.emergenciaTel??"",onChange:s=>j("emergenciaTel",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Condición médica"}),e.jsx(l,{value:h.medico??"",onChange:s=>j("medico",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Banco / Plataforma"}),e.jsx(l,{value:h.banco??"",onChange:s=>j("banco",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Monto (L)"}),e.jsx(l,{value:h.monto??"",onChange:s=>j("monto",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Número de referencia"}),e.jsx(l,{value:h.referencia??"",onChange:s=>j("referencia",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(n,{children:"Tiempo oficial (mm:ss, hh:mm:ss, NT/NS/DNS/DNF)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(l,{value:ke,onChange:s=>P(s.target.value),placeholder:"mm:ss",className:"sm:flex-1"}),e.jsx(x,{type:"button",variant:"outline",onClick:()=>P(""),children:"Limpiar"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Usa NT (No Time), NS (No Show), DNS o DNF para casos especiales."})]})]}),e.jsxs("div",{className:"rounded-md border border-dashed border-border bg-muted/40 p-4 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Dorsal:"})," #",S.dorsal]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Registrado:"})," ",ne(S.createdAt)]}),S.comprobanteUrl&&e.jsxs("p",{children:[e.jsx("strong",{children:"Comprobante:"})," ",e.jsx("a",{href:S.comprobanteUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"Ver comprobante"})]})]}),Ee&&e.jsx("p",{className:"text-sm text-destructive",children:Ee})]}),e.jsxs(xe,{children:[e.jsx(x,{variant:"outline",type:"button",onClick:le,disabled:ee,children:"Cancelar"}),e.jsx(x,{type:"button",onClick:ms,disabled:ee,children:ee?"Guardando…":"Guardar cambios"})]})]})}),e.jsx(Le,{open:We,onOpenChange:s=>{s?F(!0):(F(!1),O(""),r.reset())},children:e.jsx(de,{className:"max-w-3xl",children:e.jsxs("form",{onSubmit:xs,className:"space-y-6",children:[e.jsxs(me,{children:[e.jsx(he,{children:"Nueva inscripción manual"}),e.jsx(ue,{children:es})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-nombre",children:"Nombre completo *"}),e.jsx(l,{id:"create-nombre",...r.register("nombre")}),r.formState.errors.nombre&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.nombre.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-dni",children:"DNI (13 dígitos) *"}),e.jsx(l,{id:"create-dni",maxLength:13,inputMode:"numeric",...r.register("dni"),onChange:s=>r.setValue("dni",s.target.value.replace(/\D/g,"").slice(0,13))}),r.formState.errors.dni&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.dni.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-nacimiento",children:"Fecha de nacimiento *"}),e.jsx(l,{type:"date",id:"create-nacimiento",...r.register("nacimiento")}),r.formState.errors.nacimiento&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.nacimiento.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-email",children:"Email *"}),e.jsx(l,{type:"email",id:"create-email",...r.register("email")}),r.formState.errors.email&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-telefono",children:"Teléfono *"}),e.jsx(l,{id:"create-telefono",...r.register("telefono")}),r.formState.errors.telefono&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.telefono.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-club",children:"Club / Equipo"}),e.jsx(l,{id:"create-club",...r.register("club")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Distancia *"}),e.jsxs($,{value:r.watch("distancia"),onValueChange:s=>r.setValue("distancia",s),children:[e.jsx(H,{children:e.jsx(_,{placeholder:"Selecciona distancia"})}),e.jsxs(G,{children:[e.jsx(w,{value:"800m",children:"800 metros"}),e.jsx(w,{value:"2km",children:"2 kilómetros"}),e.jsx(w,{value:"5km",children:"5 kilómetros"})]})]}),r.formState.errors.distancia&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.distancia.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Sexo *"}),e.jsxs($,{value:r.watch("sexo"),onValueChange:s=>r.setValue("sexo",s),children:[e.jsx(H,{children:e.jsx(_,{placeholder:"Selecciona sexo"})}),e.jsxs(G,{children:[e.jsx(w,{value:"F",children:"Femenino"}),e.jsx(w,{value:"M",children:"Masculino"})]})]}),r.formState.errors.sexo&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.sexo.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Talla de camisa"}),e.jsx(l,{list:"shirt-sizes",...r.register("tallaCamisa")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Contacto de emergencia"}),e.jsx(l,{...r.register("emergenciaNombre")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Teléfono de emergencia"}),e.jsx(l,{...r.register("emergenciaTel")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Condición médica"}),e.jsx(l,{...r.register("medico")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Banco / Plataforma *"}),e.jsx(l,{...r.register("banco")}),r.formState.errors.banco&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.banco.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Monto (L) *"}),e.jsx(l,{...r.register("monto")}),r.formState.errors.monto&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.monto.message})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(n,{children:"Número de referencia *"}),e.jsx(l,{...r.register("referencia")}),r.formState.errors.referencia&&e.jsx("p",{className:"text-xs text-destructive",children:r.formState.errors.referencia.message})]})]}),De&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive",children:[e.jsx(Ts,{className:"h-4 w-4"}),e.jsx("span",{children:De})]}),e.jsxs(xe,{children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>{F(!1),O(""),r.reset()},disabled:ae,children:"Cancelar"}),e.jsx(x,{type:"submit",disabled:ae,children:ae?"Guardando…":"Crear inscripción"})]})]})})}),e.jsx(Is,{})]})]})};export{Qs as default};
