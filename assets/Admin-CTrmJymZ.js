import{r as l,j as e,X as Ke,S as Ze,P as es,N as ss,T as as,U as ts,V as ns,O as rs,D as ls,W as is,Y as os}from"./vendor-BlfV3RTz.js";import{N as Q,C as v,a as p,b as f,c as y,d as W}from"./card-B07rxTTS.js";import{F as cs}from"./footer-ChGT9lhB.js";import{B as u}from"./button-DyqYNJZU.js";import{I as d}from"./input-CkO7rcZN.js";import{L as i,S as ue,a as he,b as je,c as ge,d as I}from"./select-BVExiMW0.js";import{c as w,a as ds,u as ms}from"./index-DcANwrkq.js";import{k as xs,m as us,n as P,F as hs,p as Ne}from"./firebase-BIHwqxFo.js";import{O as ve,f as pe,g as js,h as fe,i as be,j as gs,k as Ns}from"./radix-C6NXPyZw.js";const vs=gs,ps=Ns,ye=l.forwardRef(({className:j,...g},N)=>e.jsx(ve,{ref:N,className:w("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",j),...g}));ye.displayName=ve.displayName;const Ce=l.forwardRef(({className:j,children:g,...N},c)=>e.jsxs(ps,{children:[e.jsx(ye,{}),e.jsxs(pe,{ref:c,className:w("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",j),...N,children:[g,e.jsxs(js,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ce.displayName=pe.displayName;const we=({className:j,...g})=>e.jsx("div",{className:w("flex flex-col space-y-1.5 text-center sm:text-left",j),...g});we.displayName="DialogHeader";const Se=({className:j,...g})=>e.jsx("div",{className:w("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",j),...g});Se.displayName="DialogFooter";const ke=l.forwardRef(({className:j,...g},N)=>e.jsx(fe,{ref:N,className:w("text-lg font-semibold leading-none tracking-tight",j),...g}));ke.displayName=fe.displayName;const Ee=l.forwardRef(({className:j,...g},N)=>e.jsx(be,{ref:N,className:w("text-sm text-muted-foreground",j),...g}));Ee.displayName=be.displayName;const Ts=()=>{const j=["NT","NS","DNS","DNF"],g=["12","14","16","XS","S","M","L","XL","XXL"],N=new Date("2025-10-12"),{toast:c}=ds(),{registrations:A,stats:C,updateRegistrationStatus:De,toggleCheckIn:Te,updateRegistrationResult:K,updateRegistrationData:Ie,isLoading:Ae,error:Z}=ms(),U=l.useMemo(()=>"gustavomartinezh87@gmail.com,admin@losnaranjos.com".split(",").map(s=>s.trim().toLowerCase()).filter(Boolean),[]),ee="".trim(),[S,se]=l.useState({email:"",password:""}),[ae,V]=l.useState(null),[k,E]=l.useState(null),[D,R]=l.useState(null),[Re,te]=l.useState(!0),[ne,re]=l.useState(!1),[q,Le]=l.useState(""),[L,Fe]=l.useState(""),[F,ze]=l.useState(""),[z,Be]=l.useState(""),[O,le]=l.useState({}),[Me,ie]=l.useState({}),[Pe,$]=l.useState(!1),[b,oe]=l.useState(null),[m,H]=l.useState({}),[ce,B]=l.useState(""),[de,M]=l.useState(""),[J,X]=l.useState(!1),Ue=s=>{if(!s)return null;const a=new Date(s);if(Number.isNaN(a.getTime()))return null;let t=N.getFullYear()-a.getFullYear();return N.getMonth()>a.getMonth()||N.getMonth()===a.getMonth()&&N.getDate()>=a.getDate()||(t-=1),t},me=(s,a)=>{if(!s||!a)return"";const t=Ue(s);return t===null?"":a==="800m"?t>=9&&t<=10?"Infantiles A (9-10)":t>=11&&t<=12?"Infantiles B (11-12)":t>=13&&t<=14?"Juveniles A (13-14)":t>=15?"Masters":"":t>=15&&t<=17?"Juveniles B (15-17)":t>=18&&t<=30?"20-30":t>=31&&t<=40?"30-40":"40+"},Ve=async s=>{s.preventDefault(),re(!0),V(null);try{const a=S.email.trim().toLowerCase();if(!U.includes(a))throw new Error("Este correo no está autorizado para acceder al panel.");if(ee&&S.password===ee){E(null),R({email:a}),te(!1),c({title:"Acceso autorizado",description:"Sesión iniciada en modo local"});return}await us(P,a,S.password),c({title:"Acceso autorizado",description:"Bienvenido al panel de administración"})}catch(a){let t="No se pudo autenticar. Intenta nuevamente.";if(a instanceof hs)switch(a.code){case"auth/invalid-credential":case"auth/wrong-password":t="Contraseña incorrecta.";break;case"auth/user-not-found":t="No existe un usuario con ese correo.";break;case"auth/too-many-requests":t="Demasiados intentos. Espera unos minutos antes de volver a intentar.";break;default:t=a.message}else a instanceof Error&&(t=a.message);V(t),c({variant:"destructive",title:"Error",description:t})}finally{re(!1)}};l.useEffect(()=>{const s=xs(P,async a=>{var t;if(V(null),a){const r=((t=a.email)==null?void 0:t.toLowerCase())??"";U.includes(r)?(E(a),R(null)):(await Ne(P),E(null),R(null),c({variant:"destructive",title:"Acceso denegado",description:"Tu cuenta no tiene permiso para acceder al panel de administración."}))}else E(null);te(!1)});return()=>s()},[U,c]);const T=(k==null?void 0:k.email)??(D==null?void 0:D.email)??"",qe=async()=>{try{k&&await Ne(P),R(null),E(null),c({title:"Sesión cerrada",description:"Has salido del panel de administración."})}catch{c({variant:"destructive",title:"Error",description:"No se pudo cerrar la sesión. Intenta nuevamente."})}},xe=l.useMemo(()=>{const s=q.trim().toLowerCase();return A.filter(a=>{const t=!s||[a.nombre,a.dni,a.email,a.telefono,a.referencia,a.dorsal].map(n=>String(n||"").toLowerCase()).some(n=>n.includes(s)),r=!L||a.status===L,o=!F||a.distancia===F,h=!z||a.categoria===z;return t&&r&&o&&h}).sort((a,t)=>{const r=parseInt(a.dorsal??"0",10),o=parseInt(t.dorsal??"0",10);return Number.isFinite(r)&&Number.isFinite(o)&&r!==o?r-o:new Date(a.createdAt).getTime()-new Date(t.createdAt).getTime()})},[A,q,L,F,z]),_=s=>{const a=new Date(s);return Number.isNaN(a.getTime())?s:a.toLocaleString("es-HN",{dateStyle:"medium",timeStyle:"short"})},Oe=s=>s.id in O?O[s.id]:s.resultTime??"",$e=(s,a)=>{le(t=>({...t,[s]:a}))},He=async s=>{const t=(O[s.id]??s.resultTime??"").trim(),r=t?j.includes(t.toUpperCase())?t.toUpperCase():t:"";ie(o=>({...o,[s.id]:!0}));try{await K(s.id,r||null,T||"admin"),le(o=>({...o,[s.id]:r})),c({title:"Resultado actualizado",description:r?`Tiempo guardado: ${r}`:"Resultado eliminado"})}catch(o){const h=o instanceof Error?o.message:"No se pudo guardar el resultado.";c({variant:"destructive",title:"Error al guardar",description:h})}finally{ie(o=>({...o,[s.id]:!1}))}},G=async(s,a)=>{const t={validated:{title:"Inscripción validada",description:"El participante aparece ahora como validado en el panel."},rejected:{title:"Inscripción rechazada",description:"Recuerda comunicar al participante el motivo del rechazo."},pending:{title:"Inscripción pendiente",description:"El registro volvió al estado pendiente para revisión."}};try{await De(s,a,T||"admin",a==="pending"?{checkedInAt:null,checkedInBy:null}:{}),c(t[a])}catch(r){console.error("Error al actualizar estado",r),c({variant:"destructive",title:"Error",description:"No se pudo actualizar el estado. Intenta nuevamente."})}},Je=s=>{c({title:s.nombre,description:`DNI: ${s.dni} | Email: ${s.email} | Tel: ${s.telefono||"No indicado"} | Talla: ${s.tallaCamisa||"No indicada"} | Comprobante: ${s.comprobanteNombre??"No adjuntado"}`})},Xe=s=>{if(!s.comprobanteUrl){c({variant:"destructive",title:"Sin comprobante",description:"Este registro no tiene un comprobante adjunto."});return}window.open(s.comprobanteUrl,"_blank","noopener,noreferrer")},_e=async s=>{try{const a=!s.checkedInAt;await Te(s.id,a,T||"admin@losnaranjos.com"),c({title:a?"Check-in registrado":"Check-in revertido",description:a?`El participante ${s.nombre} quedó marcado como presente.`:`El check-in de ${s.nombre} fue revertido.`})}catch(a){console.error("Error al registrar check-in",a),c({variant:"destructive",title:"Error",description:"No se pudo registrar el check-in. Intenta nuevamente."})}},Ge=s=>{oe(s);const a={nombre:s.nombre,dni:s.dni,dorsal:s.dorsal,nacimiento:s.nacimiento,email:s.email,telefono:s.telefono,club:s.club,distancia:s.distancia||"800m",sexo:s.sexo||"M",categoria:s.categoria,emergenciaNombre:s.emergenciaNombre,emergenciaTel:s.emergenciaTel,medico:s.medico,banco:s.banco,monto:s.monto,referencia:s.referencia,tallaCamisa:s.tallaCamisa};a.distancia||(a.distancia="800m"),a.categoria=me(a.nacimiento??"",a.distancia??""),H(a),B(s.resultTime??""),M(""),$(!0)},Y=()=>{$(!1),oe(null),H({}),B(""),M(""),X(!1)},x=(s,a)=>{H(t=>{const r={...t,[s]:a};if(s==="nacimiento"||s==="distancia"){const o=s==="nacimiento"?a:r.nacimiento??"",h=s==="distancia"?a:r.distancia??"";r.categoria=me(o??"",h??"")}return r})},Ye=async()=>{if(b){X(!0),M("");try{await Ie(b.id,m,T||"admin");const s=ce.trim(),a=b.resultTime??"";if(s!==a.trim()){let r=null;if(s){const o=s.toUpperCase();if(j.includes(o))r=o;else{const h=s.split(":").map(n=>n.trim());if(h.some(n=>n===""||Number.isNaN(Number(n))))throw new Error("Formato de tiempo inválido. Usa mm:ss, hh:mm:ss o los códigos NT/NS.");if(h.length!==2&&h.length!==3)throw new Error("Formato de tiempo inválido. Usa mm:ss o hh:mm:ss.");r=s}}await K(b.id,r,T||"admin")}c({title:"Datos actualizados",description:"La inscripción se actualizó correctamente."}),Y()}catch(s){const a=s instanceof Error?s.message:"No se pudo actualizar la inscripción.";M(a),c({variant:"destructive",title:"Error al editar",description:a})}finally{X(!1)}}},Qe=()=>{if(!A.length){c({title:"Sin datos",description:"Aún no hay inscripciones para exportar."});return}const s=["Dorsal","Nombre","DNI","Email","Teléfono","Distancia","Categoría","Talla","Banco","Monto","Referencia","Estado","Check-in","Check-in por","Fecha registro","URL comprobante"],a=A.map(n=>[n.dorsal,n.nombre,n.dni,n.email,n.telefono,n.distancia,n.categoria,n.tallaCamisa,n.banco,n.monto,n.referencia,n.status,n.checkedInAt?n.checkedInAt:"",n.checkedInBy??"",n.createdAt,n.comprobanteUrl??""]),t=[s,...a].map(n=>n.map(We=>`"${String(We??"").replace(/"/g,'""')}"`).join(",")).join(`
`),r=new Blob([t],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(r),h=document.createElement("a");h.href=o,h.download=`inscripciones-${new Date().toISOString()}.csv`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(o),c({title:"Exportación lista",description:"El archivo CSV se descargó correctamente."})};return Re&&!D?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Q,{}),e.jsx("div",{className:"flex items-center justify-center px-4 py-32",children:e.jsx(v,{className:"card-gradient shadow-card max-w-sm w-full",children:e.jsxs(p,{className:"text-center",children:[e.jsx(f,{className:"text-xl",children:"Cargando autenticación..."}),e.jsx(y,{children:"Por favor espera un momento."})]})})})]}):!k&&!D?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Q,{}),e.jsx("div",{className:"max-w-md mx-auto px-4 py-16",children:e.jsxs(v,{className:"card-gradient shadow-card",children:[e.jsxs(p,{className:"text-center",children:[e.jsx(Ze,{className:"h-16 w-16 text-primary mx-auto mb-4"}),e.jsx(f,{className:"text-2xl",children:"Acceso Restringido"}),e.jsx(y,{children:"Panel de administración del Encuentro de Aguas Abiertas Los Naranjos"})]}),e.jsxs(W,{children:[e.jsxs("form",{onSubmit:Ve,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",type:"email",value:S.email,onChange:s=>se(a=>({...a,email:s.target.value})),required:!0,placeholder:"admin@losnaranjos.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"password",children:"Contraseña"}),e.jsx(d,{id:"password",type:"password",value:S.password,onChange:s=>se(a=>({...a,password:s.target.value})),required:!0,placeholder:"••••••••"})]}),e.jsx(u,{type:"submit",className:"w-full button-gradient shadow-button",disabled:ne,children:ne?e.jsx(e.Fragment,{children:"Verificando..."}):e.jsxs(e.Fragment,{children:[e.jsx(es,{className:"mr-2 h-4 w-4"}),"Iniciar Sesión"]})}),ae&&e.jsx("p",{className:"text-sm text-destructive text-center",children:ae})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:e.jsx("p",{children:"Ingresa con una cuenta autorizada."})})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Q,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Panel de Administración"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión de inscripciones - Los Naranjos 2025"})]}),e.jsx(u,{variant:"outline",onClick:qe,children:"Cerrar Sesión"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-6 mb-8",children:[e.jsx(v,{className:"card-gradient shadow-card",children:e.jsxs(p,{className:"text-center pb-3",children:[e.jsx(f,{className:"text-2xl text-primary",children:C.total}),e.jsx(y,{children:"Total Inscritos"})]})}),e.jsx(v,{className:"card-gradient shadow-card",children:e.jsxs(p,{className:"text-center pb-3",children:[e.jsx(f,{className:"text-2xl text-warm-accent",children:C.pending}),e.jsx(y,{children:"Pendientes"})]})}),e.jsx(v,{className:"card-gradient shadow-card",children:e.jsxs(p,{className:"text-center pb-3",children:[e.jsx(f,{className:"text-2xl text-lake-green",children:C.validated}),e.jsx(y,{children:"Validados"})]})}),e.jsx(v,{className:"card-gradient shadow-card",children:e.jsxs(p,{className:"text-center pb-3",children:[e.jsx(f,{className:"text-2xl text-secondary",children:C.checkedIn}),e.jsx(y,{children:"Check-in"})]})}),e.jsx(v,{className:"card-gradient shadow-card",children:e.jsxs(p,{className:"text-center pb-3",children:[e.jsx(f,{className:"text-2xl text-destructive",children:C.rejected}),e.jsx(y,{children:"Rechazados"})]})}),e.jsx(v,{className:"card-gradient shadow-card",children:e.jsxs(p,{className:"text-center pb-3",children:[e.jsx(f,{className:"text-2xl text-primary",children:C.remaining}),e.jsx(y,{children:"Cupos Restantes"})]})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-8",children:[e.jsxs(u,{className:"button-gradient shadow-button",onClick:Qe,children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),"Exportar CSV"]}),e.jsxs(u,{variant:"outline",children:[e.jsx(as,{className:"mr-2 h-4 w-4"}),"Lector QR"]}),e.jsxs(u,{variant:"outline",children:[e.jsx(ts,{className:"mr-2 h-4 w-4"}),"Check-in"]})]}),e.jsxs(v,{className:"card-gradient shadow-card mb-8",children:[e.jsx(p,{children:e.jsx(f,{className:"text-xl text-primary",children:"Filtros y Búsqueda"})}),e.jsxs(W,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(d,{className:"pl-10",placeholder:"DNI, nombre, referencia...",value:q,onChange:s=>Le(s.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Estado"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-md bg-background",value:L,onChange:s=>Fe(s.target.value),children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pending",children:"Pendientes"}),e.jsx("option",{value:"validated",children:"Validados"}),e.jsx("option",{value:"rejected",children:"Rechazados"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Distancia"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-md bg-background",value:F,onChange:s=>ze(s.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),e.jsx("option",{value:"800m",children:"800m"}),e.jsx("option",{value:"2km",children:"2km"}),e.jsx("option",{value:"5km",children:"5km"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Categoría"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-md bg-background",value:z,onChange:s=>Be(s.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),e.jsx("option",{value:"Infantiles A (9-10)",children:"Infantiles A (9-10)"}),e.jsx("option",{value:"Infantiles B (11-12)",children:"Infantiles B (11-12)"}),e.jsx("option",{value:"Juveniles A (13-14)",children:"Juveniles A (13-14)"}),e.jsx("option",{value:"Juveniles B (15-17)",children:"Juveniles B (15-17)"}),e.jsx("option",{value:"20-30",children:"20-30"}),e.jsx("option",{value:"30-40",children:"30-40"}),e.jsx("option",{value:"40+",children:"40+"}),e.jsx("option",{value:"Masters",children:"Masters"})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Registra tiempos en formato ",e.jsx("strong",{children:"mm:ss"})," o ",e.jsx("strong",{children:"hh:mm:ss"}),". También puedes usar los códigos",e.jsx("strong",{children:" NT"})," (No Time) y ",e.jsx("strong",{children:"NS"})," (No Show) cuando corresponda."]})]})]}),e.jsxs(v,{className:"card-gradient shadow-card",children:[e.jsx(p,{children:e.jsx(f,{className:"text-xl text-primary",children:"Inscripciones"})}),e.jsx(W,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm md:text-base",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"text-left py-4 px-3",children:"Fecha"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Dorsal"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Nombre"}),e.jsx("th",{className:"text-left py-4 px-3",children:"DNI"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Distancia"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Categoría"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Tiempo"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Talla"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Banco"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Monto"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Referencia"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Check-in"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Estado"}),e.jsx("th",{className:"text-left py-4 px-3",children:"Acciones"})]})}),e.jsx("tbody",{children:Ae?e.jsx("tr",{children:e.jsx("td",{className:"py-6 text-center text-muted-foreground",colSpan:14,children:"Cargando inscripciones..."})}):Z?e.jsx("tr",{children:e.jsx("td",{className:"py-6 text-center text-destructive",colSpan:14,children:Z})}):xe.length===0?e.jsx("tr",{children:e.jsx("td",{className:"py-6 text-center text-muted-foreground",colSpan:14,children:"No hay inscripciones que coincidan con los filtros seleccionados."})}):xe.map(s=>e.jsxs("tr",{className:"border-b border-border hover:bg-muted/30",children:[e.jsx("td",{className:"py-4 px-3",children:_(s.createdAt)}),e.jsxs("td",{className:"py-4 px-3 font-mono whitespace-nowrap",children:["#",s.dorsal]}),e.jsx("td",{className:"py-4 px-3 font-medium whitespace-normal",children:s.nombre}),e.jsx("td",{className:"py-4 px-3 font-mono text-xs md:text-sm whitespace-nowrap",children:s.dni}),e.jsx("td",{className:"py-4 px-3",children:s.distancia}),e.jsx("td",{className:"py-4 px-3",children:s.categoria||"N/A"}),e.jsx("td",{className:"py-4 px-3 min-w-[220px]",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{value:Oe(s),onChange:a=>$e(s.id,a.target.value),placeholder:"mm:ss o NT/NS",className:"h-9"}),e.jsxs(u,{type:"button",size:"sm",className:"flex items-center gap-1",disabled:Me[s.id],onClick:()=>He(s),children:[e.jsx(rs,{className:"h-4 w-4"}),"Guardar"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[s.resultTime?e.jsxs("span",{className:"flex items-center gap-1 text-primary",children:[e.jsx(ls,{className:"h-3 w-3"}),s.resultTime]}):e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(is,{className:"h-3 w-3"}),"Pendiente"]}),s.resultRecordedAt&&e.jsxs("span",{children:["· ",new Date(s.resultRecordedAt).toLocaleString("es-HN")]})]})]})}),e.jsx("td",{className:"py-4 px-3",children:s.tallaCamisa||"N/A"}),e.jsx("td",{className:"py-4 px-3",children:s.banco||"N/A"}),e.jsx("td",{className:"py-4 px-3",children:s.monto?`L ${s.monto}`:"N/A"}),e.jsx("td",{className:"py-4 px-3 font-mono text-xs md:text-sm whitespace-nowrap",children:s.referencia||"N/A"}),e.jsx("td",{className:"py-4 px-3",children:s.checkedInAt?_(s.checkedInAt):"Pendiente"}),e.jsx("td",{className:"py-4 px-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="validated"?"bg-lake-green/20 text-lake-green":s.status==="pending"?"bg-warm-accent/20 text-warm-accent":"bg-destructive/20 text-destructive"}`,children:s.status==="validated"?"Validado":s.status==="pending"?"Pendiente":"Rechazado"})}),e.jsx("td",{className:"py-4 px-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(u,{size:"sm",variant:"outline",onClick:()=>Je(s),children:"Ver"}),e.jsx(u,{size:"sm",variant:"outline",onClick:()=>Xe(s),disabled:!s.comprobanteUrl,children:"Comprobante"}),e.jsxs(u,{size:"sm",variant:"outline",className:"gap-1",onClick:()=>Ge(s),children:[e.jsx(os,{className:"h-3.5 w-3.5"}),"Editar"]}),e.jsx(u,{size:"sm",variant:"outline",className:s.checkedInAt?"bg-lake-green/10 text-lake-green":"",onClick:()=>_e(s),disabled:s.status==="rejected"||s.status==="pending"&&!s.checkedInAt,children:s.checkedInAt?"Revertir":"Check-in"}),s.status==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(u,{size:"sm",variant:"outline",className:"text-lake-green",onClick:()=>G(s.id,"validated"),children:"✓"}),e.jsx(u,{size:"sm",variant:"outline",className:"text-destructive",onClick:()=>G(s.id,"rejected"),children:"✗"})]}):e.jsx(u,{size:"sm",variant:"outline",onClick:()=>G(s.id,"pending"),children:"Pend."})]})})]},s.id))})]})})})]}),e.jsx(vs,{open:Pe,onOpenChange:s=>s?$(!0):Y(),children:e.jsxs(Ce,{className:"max-w-3xl",children:[e.jsxs(we,{children:[e.jsx(ke,{children:"Editar inscripción"}),e.jsx(Ee,{children:"Ajusta los datos del participante para corregir información suministrada por error."})]}),b&&e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Nombre completo"}),e.jsx(d,{value:m.nombre??"",onChange:s=>x("nombre",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"DNI (13 dígitos)"}),e.jsx(d,{value:m.dni??"",onChange:s=>x("dni",s.target.value.replace(/\D/g,"").slice(0,13)),maxLength:13,inputMode:"numeric",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Dorsal"}),e.jsx(d,{value:m.dorsal??"",onChange:s=>x("dorsal",s.target.value.replace(/\D/g,"").slice(0,3)),maxLength:3,inputMode:"numeric",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Fecha de nacimiento"}),e.jsx(d,{type:"date",value:m.nacimiento??"",onChange:s=>x("nacimiento",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Email"}),e.jsx(d,{type:"email",value:m.email??"",onChange:s=>x("email",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Teléfono"}),e.jsx(d,{value:m.telefono??"",onChange:s=>x("telefono",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Club / Equipo"}),e.jsx(d,{value:m.club??"",onChange:s=>x("club",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Distancia"}),e.jsxs(ue,{value:m.distancia??"800m",onValueChange:s=>x("distancia",s),children:[e.jsx(he,{children:e.jsx(je,{placeholder:"Selecciona distancia"})}),e.jsxs(ge,{children:[e.jsx(I,{value:"800m",children:"800 metros"}),e.jsx(I,{value:"2km",children:"2 kilómetros"}),e.jsx(I,{value:"5km",children:"5 kilómetros"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Sexo"}),e.jsxs(ue,{value:m.sexo??"M",onValueChange:s=>x("sexo",s),children:[e.jsx(he,{children:e.jsx(je,{placeholder:"Selecciona sexo"})}),e.jsxs(ge,{children:[e.jsx(I,{value:"F",children:"Femenino"}),e.jsx(I,{value:"M",children:"Masculino"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Categoría asignada"}),e.jsx(d,{value:m.categoria??"",readOnly:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Talla de camisa"}),e.jsx(d,{value:m.tallaCamisa??"",onChange:s=>x("tallaCamisa",s.target.value),list:"shirt-sizes"}),e.jsx("datalist",{id:"shirt-sizes",children:g.map(s=>e.jsx("option",{value:s},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Contacto de emergencia"}),e.jsx(d,{value:m.emergenciaNombre??"",onChange:s=>x("emergenciaNombre",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Teléfono de emergencia"}),e.jsx(d,{value:m.emergenciaTel??"",onChange:s=>x("emergenciaTel",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Condición médica"}),e.jsx(d,{value:m.medico??"",onChange:s=>x("medico",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Banco / Plataforma"}),e.jsx(d,{value:m.banco??"",onChange:s=>x("banco",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Monto (L)"}),e.jsx(d,{value:m.monto??"",onChange:s=>x("monto",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Número de referencia"}),e.jsx(d,{value:m.referencia??"",onChange:s=>x("referencia",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(i,{children:"Tiempo oficial (mm:ss, hh:mm:ss, NT/NS/DNS/DNF)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(d,{value:ce,onChange:s=>B(s.target.value),placeholder:"mm:ss",className:"sm:flex-1"}),e.jsx(u,{type:"button",variant:"outline",onClick:()=>B(""),children:"Limpiar"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Usa NT (No Time), NS (No Show), DNS o DNF para casos especiales."})]})]}),e.jsxs("div",{className:"rounded-md border border-dashed border-border bg-muted/40 p-4 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Dorsal:"})," #",b.dorsal]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Registrado:"})," ",_(b.createdAt)]}),b.comprobanteUrl&&e.jsxs("p",{children:[e.jsx("strong",{children:"Comprobante:"})," ",e.jsx("a",{href:b.comprobanteUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"Ver comprobante"})]})]}),de&&e.jsx("p",{className:"text-sm text-destructive",children:de})]}),e.jsxs(Se,{children:[e.jsx(u,{variant:"outline",type:"button",onClick:Y,disabled:J,children:"Cancelar"}),e.jsx(u,{type:"button",onClick:Ye,disabled:J,children:J?"Guardando…":"Guardar cambios"})]})]})}),e.jsx(cs,{})]})]})};export{Ts as default};
