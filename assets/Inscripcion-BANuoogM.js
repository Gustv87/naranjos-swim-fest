import{r as u,j as e,A as ee,E as Ne,G as ae,I as Q,L as T,J as P,K as ve,z as ye}from"./vendor-BSf5XApu.js";import{N as z,C as g,a as b,b as N,c as _,d as v,B as A}from"./card-B_2yIsY5.js";import{F as Ce}from"./firebase-DtyALkpc.js";import{L as c,I as x}from"./label-DRkKdC70.js";import{c as se,I as we,S as re,d as ie,e as Ee,f as te,g as Se,L as ne,h as oe,i as Fe,j as ke,k as ce,l as Ie,m as De,n as le,o as Te}from"./radix-CKG2RIUU.js";import{c as h,a as Ae,u as Le}from"./index-D5TUlcfZ.js";import{C as W}from"./capacity-indicator-C0UsTL9l.js";const L=Ie,B=De,E=u.forwardRef(({className:t,children:o,...n},j)=>e.jsxs(se,{ref:j,className:h("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[o,e.jsx(we,{asChild:!0,children:e.jsx(ee,{className:"h-4 w-4 opacity-50"})})]}));E.displayName=se.displayName;const de=u.forwardRef(({className:t,...o},n)=>e.jsx(re,{ref:n,className:h("flex cursor-default items-center justify-center py-1",t),...o,children:e.jsx(Ne,{className:"h-4 w-4"})}));de.displayName=re.displayName;const me=u.forwardRef(({className:t,...o},n)=>e.jsx(ie,{ref:n,className:h("flex cursor-default items-center justify-center py-1",t),...o,children:e.jsx(ee,{className:"h-4 w-4"})}));me.displayName=ie.displayName;const S=u.forwardRef(({className:t,children:o,position:n="popper",...j},F)=>e.jsx(Ee,{children:e.jsxs(te,{ref:F,className:h("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...j,children:[e.jsx(de,{}),e.jsx(Se,{className:h("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:o}),e.jsx(me,{})]})}));S.displayName=te.displayName;const Be=u.forwardRef(({className:t,...o},n)=>e.jsx(ne,{ref:n,className:h("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...o}));Be.displayName=ne.displayName;const f=u.forwardRef(({className:t,children:o,...n},j)=>e.jsxs(oe,{ref:j,className:h("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Fe,{children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsx(ke,{children:o})]}));f.displayName=oe.displayName;const Re=u.forwardRef(({className:t,...o},n)=>e.jsx(ce,{ref:n,className:h("-mx-1 my-1 h-px bg-muted",t),...o}));Re.displayName=ce.displayName;const ue=u.forwardRef(({className:t,...o},n)=>e.jsx("textarea",{className:h("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...o}));ue.displayName="Textarea";const pe=u.forwardRef(({className:t,...o},n)=>e.jsx(le,{ref:n,className:h("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...o,children:e.jsx(Te,{className:h("flex items-center justify-center text-current"),children:e.jsx(ae,{className:"h-4 w-4"})})}));pe.displayName=le.displayName;const Y=15,Me=Y*1024*1024,Xe=()=>{u.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const{toast:t}=Ae(),{addRegistration:o,stats:n,isLoading:j}=Le(),[F,O]=u.useState(!1),[R,X]=u.useState(!1),$=n.total,G=n.max,H=new Date<new Date("2025-10-08T23:59:59-06:00"),M=n.capacityFull,xe=j,[i,l]=u.useState({nombre:"",dni:"",nacimiento:"",email:"",telefono:"",club:"",distancia:"",sexo:"",emergenciaNombre:"",emergenciaTel:"",medico:"",banco:"",monto:"",referencia:"",tallaCamisa:"",comprobante:null}),[q,p]=u.useState(""),[J,C]=u.useState(""),he=["BAC Honduras"],ge=["12","14","16","XS","S","M","L","XL","XXL"],k={"800m":9,"2km":15,"5km":15},I=new Date("2025-10-12"),w=a=>{if(!a)return null;const s=new Date(a);if(Number.isNaN(s.getTime()))return null;let r=I.getFullYear()-s.getFullYear();return I.getMonth()>s.getMonth()||I.getMonth()===s.getMonth()&&I.getDate()>=s.getDate()||(r-=1),r},U=(a,s)=>{if(!a||!s)return"";const r=w(a);return r===null?"":s==="800m"?r>=9&&r<=10?"Infantiles A (9-10)":r>=11&&r<=12?"Infantiles B (11-12)":r>=13&&r<=14?"Juveniles A (13-14)":r>=15?"Masters":"":r>=15&&r<=17?"Juveniles B (15-17)":r>=18&&r<=30?"20-30":r>=31&&r<=40?"30-40":"40+"},Z=(a,s)=>{if(!a){p("");return}const r=w(a);if(r===null){p("");return}if(r<9){p("La edad mínima para participar es 9 años.");return}if(r<=10&&s&&s!=="800m"){p("Con 9 y 10 años solo puedes inscribirte en 800 metros.");return}const d=s?k[s]??9:9;if(r<d){p("Esta edad no es permitida para participar.");return}p("")},fe=a=>{l(s=>{const r={...s,nacimiento:a},d=w(a);if(d!==null){if(d<9)r.distancia="";else if(r.distancia)if(d<=10&&r.distancia!=="800m")r.distancia="";else{const D=k[r.distancia]??9;d<D&&(r.distancia="")}}return Z(r.nacimiento,r.distancia),r})},je=a=>{var r;const s=((r=a.target.files)==null?void 0:r[0])??null;if(s&&s.size>Me){t({variant:"destructive",title:"Archivo muy pesado",description:`El comprobante supera los ${Y} MB permitidos. Reduce el tamaño o utiliza un formato más liviano.`}),a.target.value="";return}l(d=>({...d,comprobante:s}))},be=async a=>{if(a.preventDefault(),!R){t({variant:"destructive",title:"Error",description:"Debes aceptar el reglamento para continuar"});return}if(!i.tallaCamisa){t({variant:"destructive",title:"Error",description:"Selecciona la talla de camisa."});return}const s=i.dni.replace(/\D/g,"");if(s.length!==13){const m="El número de identidad debe tener 13 dígitos sin guiones.";C(m),t({variant:"destructive",title:"DNI inválido",description:m});return}C("");const r=w(i.nacimiento),d=i.distancia;if(r===null){t({variant:"destructive",title:"Edad no permitida",description:"Verifica tu fecha de nacimiento."});return}if(r<9){t({variant:"destructive",title:"Edad no permitida",description:"La edad mínima para participar es 9 años."}),p("La edad mínima para participar es 9 años.");return}if(r<=10&&d&&d!=="800m"){t({variant:"destructive",title:"Edad no permitida",description:"Con 9 y 10 años solo puedes inscribirte en la distancia de 800 metros."}),p("Con 9 y 10 años solo puedes inscribirte en 800 metros.");return}const D=d?k[d]??9:9;if(r<D){t({variant:"destructive",title:"Edad no permitida",description:`La edad mínima para ${d==="800m"?"800 metros":d==="2km"?"2 kilómetros":d==="5km"?"5 kilómetros":"esta distancia"} es de ${D} años.`}),p("Esta edad no es permitida para participar.");return}if(p(""),!H){t({variant:"destructive",title:"Inscripciones cerradas",description:"El período de inscripciones ha terminado"});return}if(!navigator.onLine){t({variant:"destructive",title:"Sin conexión",description:"Verifica tu conexión a internet antes de continuar."});return}if(xe){t({title:"Cargando información",description:"Espera a que se actualice la disponibilidad de cupos antes de continuar."});return}if(M){t({variant:"destructive",title:"Cupo agotado",description:"Ya no hay cupos disponibles para este evento"});return}O(!0);try{const m=U(i.nacimiento,i.distancia);if(!m){t({variant:"destructive",title:"Error",description:"No pudimos determinar tu categoría. Verifica tu fecha de nacimiento y distancia."});return}const y=await o({nombre:i.nombre.trim(),dni:s,nacimiento:i.nacimiento,email:i.email.trim(),telefono:i.telefono.trim(),club:i.club.trim(),distancia:i.distancia,sexo:i.sexo,categoria:m,emergenciaNombre:i.emergenciaNombre.trim(),emergenciaTel:i.emergenciaTel.trim(),medico:i.medico.trim(),banco:i.banco,monto:i.monto.trim(),referencia:i.referencia.trim(),tallaCamisa:i.tallaCamisa,comprobanteFile:i.comprobante});t({title:"¡Inscripción registrada!",description:"Te contactaremos para validar tu pago."}),l({nombre:"",dni:"",nacimiento:"",email:"",telefono:"",club:"",distancia:"",sexo:"",emergenciaNombre:"",emergenciaTel:"",medico:"",banco:"",monto:"",referencia:"",tallaCamisa:"",comprobante:null}),p(""),C(""),X(!1)}catch(m){let y="No se pudo procesar tu inscripción. Intenta nuevamente.";m instanceof Ce?m.code.includes("network")||m.code==="unavailable"?y="No pudimos conectar con el servidor. Verifica tu conexión a internet e intenta nuevamente.":m.code==="storage/unauthorized"?y="No tienes permisos para subir el comprobante. Contacta al administrador.":y=m.message:m instanceof Error&&(m.message.toLowerCase().includes("dni")&&C(m.message),y=m.message==="No hay cupos disponibles"?"Ya no hay cupos disponibles para este evento.":m.message),t({variant:"destructive",title:"Error",description:y})}finally{O(!1)}},K=w(i.nacimiento),V=a=>{const s=k[a]??9;return K!==null&&K<s};return!H&&!M?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(z,{}),e.jsx("div",{className:"max-w-2xl mx-auto px-4 py-16",children:e.jsxs(g,{className:"text-center",children:[e.jsxs(b,{children:[e.jsx(Q,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),e.jsx(N,{className:"text-2xl",children:"Inscripciones Cerradas"}),e.jsx(_,{className:"text-lg",children:"El período de inscripciones terminó el 8 de octubre de 2025"})]}),e.jsx(v,{children:e.jsx(T,{to:"/",children:e.jsxs(A,{children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Volver al inicio"]})})})]})})]}):M?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(z,{}),e.jsx("div",{className:"max-w-2xl mx-auto px-4 py-16",children:e.jsxs(g,{className:"text-center",children:[e.jsxs(b,{children:[e.jsx(Q,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),e.jsx(N,{className:"text-2xl",children:"Cupo Agotado"}),e.jsx(_,{className:"text-lg",children:"Ya no hay cupos disponibles para este evento"})]}),e.jsxs(v,{children:[e.jsx(W,{current:$,max:G,className:"mb-6"}),e.jsx(T,{to:"/",children:e.jsxs(A,{children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Volver al inicio"]})})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(z,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx(T,{to:"/",children:e.jsxs(A,{variant:"ghost",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Volver al inicio"]})})}),e.jsx(g,{className:"card-gradient shadow-card mb-8",children:e.jsxs(b,{className:"text-center",children:[e.jsx(N,{className:"text-3xl text-primary",children:"Formulario de Inscripción"}),e.jsx(_,{className:"text-lg",children:"Completa todos los campos para inscribirte al Encuentro de Aguas Abiertas Los Naranjos"}),e.jsx(W,{current:$,max:G,className:"mt-4"})]})}),e.jsxs("form",{onSubmit:be,className:"space-y-8",children:[e.jsxs(g,{className:"card-gradient shadow-card",children:[e.jsx(b,{children:e.jsx(N,{className:"text-xl text-primary",children:"Datos Personales"})}),e.jsxs(v,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"nombre",children:"Nombre Completo *"}),e.jsx(x,{id:"nombre",value:i.nombre,onChange:a=>l(s=>({...s,nombre:a.target.value})),required:!0,placeholder:"Tu nombre completo"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"dni",children:"Identidad/DNI *"}),e.jsx(x,{id:"dni",value:i.dni,onChange:a=>{const s=a.target.value.replace(/\D/g,"").slice(0,13);C(""),l(r=>({...r,dni:s}))},required:!0,placeholder:"0801199012345",inputMode:"numeric",maxLength:13}),J&&e.jsx("p",{className:"text-sm text-destructive",children:J})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"nacimiento",children:"Fecha de Nacimiento *"}),e.jsx(x,{id:"nacimiento",type:"date",value:i.nacimiento,onChange:a=>fe(a.target.value),required:!0}),q&&e.jsx("p",{className:"text-sm text-destructive",children:q})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"tallaCamisa",children:"Talla de Camisa *"}),e.jsxs(L,{value:i.tallaCamisa,onValueChange:a=>l(s=>({...s,tallaCamisa:a})),children:[e.jsx(E,{id:"tallaCamisa",children:e.jsx(B,{placeholder:"Selecciona la talla"})}),e.jsx(S,{children:ge.map(a=>e.jsx(f,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"email",children:"Email *"}),e.jsx(x,{id:"email",type:"email",value:i.email,onChange:a=>l(s=>({...s,email:a.target.value})),required:!0,placeholder:"tu@email.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"telefono",children:"Teléfono *"}),e.jsx(x,{id:"telefono",value:i.telefono,onChange:a=>l(s=>({...s,telefono:a.target.value})),required:!0,placeholder:"9999-9999"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"club",children:"Club/Equipo *"}),e.jsx(x,{id:"club",value:i.club,onChange:a=>l(s=>({...s,club:a.target.value})),required:!0,placeholder:"Nombre de tu club o equipo"})]})]})]}),e.jsxs(g,{className:"card-gradient shadow-card",children:[e.jsx(b,{children:e.jsx(N,{className:"text-xl text-primary",children:"Datos de Competencia"})}),e.jsxs(v,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"distancia",children:"Distancia *"}),e.jsxs(L,{value:i.distancia,onValueChange:a=>l(s=>{const r={...s,distancia:a};return Z(r.nacimiento,r.distancia),r}),required:!0,children:[e.jsx(E,{children:e.jsx(B,{placeholder:"Selecciona la distancia"})}),e.jsxs(S,{children:[e.jsx(f,{value:"800m",disabled:V("800m"),children:"800 metros"}),e.jsx(f,{value:"2km",disabled:V("2km"),children:"2 kilómetros"}),e.jsx(f,{value:"5km",disabled:V("5km"),children:"5 kilómetros"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"sexo",children:"Sexo *"}),e.jsxs(L,{value:i.sexo,onValueChange:a=>l(s=>({...s,sexo:a})),required:!0,children:[e.jsx(E,{children:e.jsx(B,{placeholder:"Selecciona tu sexo"})}),e.jsxs(S,{children:[e.jsx(f,{value:"F",children:"Femenino"}),e.jsx(f,{value:"M",children:"Masculino"})]})]})]}),i.distancia&&i.nacimiento&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(c,{children:"Categoría"}),e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx("span",{className:"font-semibold text-primary",children:U(i.nacimiento,i.distancia)})})]})]})]}),e.jsxs(g,{className:"card-gradient shadow-card",children:[e.jsx(b,{children:e.jsx(N,{className:"text-xl text-primary",children:"Contacto de Emergencia"})}),e.jsxs(v,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"emergenciaNombre",children:"Nombre *"}),e.jsx(x,{id:"emergenciaNombre",value:i.emergenciaNombre,onChange:a=>l(s=>({...s,emergenciaNombre:a.target.value})),required:!0,placeholder:"Nombre del contacto"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"emergenciaTel",children:"Teléfono *"}),e.jsx(x,{id:"emergenciaTel",value:i.emergenciaTel,onChange:a=>l(s=>({...s,emergenciaTel:a.target.value})),required:!0,placeholder:"9999-9999"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(c,{htmlFor:"medico",children:"Condición médica relevante (opcional)"}),e.jsx(ue,{id:"medico",value:i.medico,onChange:a=>l(s=>({...s,medico:a.target.value})),placeholder:"Medicamentos, alergias, condiciones médicas importantes...",rows:3})]})]})]}),e.jsxs(g,{className:"card-gradient shadow-card",children:[e.jsx(b,{children:e.jsx(N,{className:"text-xl text-primary",children:"Información de Pago"})}),e.jsxs(v,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"banco",children:"Banco/Plataforma *"}),e.jsxs(L,{value:i.banco,onValueChange:a=>l(s=>({...s,banco:a})),required:!0,children:[e.jsx(E,{children:e.jsx(B,{placeholder:"Selecciona el banco"})}),e.jsx(S,{children:he.map(a=>e.jsx(f,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"monto",children:"Monto (L) *"}),e.jsx(x,{id:"monto",type:"number",step:"0.01",value:i.monto,onChange:a=>l(s=>({...s,monto:a.target.value})),required:!0,placeholder:"300.00"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(c,{htmlFor:"referencia",children:"Número de referencia/transacción *"}),e.jsx(x,{id:"referencia",value:i.referencia,onChange:a=>l(s=>({...s,referencia:a.target.value})),required:!0,placeholder:"Número de confirmación del pago"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"comprobante",children:["Comprobante de pago * (PDF, JPG, PNG - máx. ",Y,"MB)"]}),e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center",children:[e.jsx(ve,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx(x,{id:"comprobante",type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:je,required:!0,className:"max-w-sm mx-auto"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Sube tu comprobante de pago"})]})]})]})]}),e.jsx(g,{className:"card-gradient shadow-card",children:e.jsx(v,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(pe,{id:"rules",checked:R,onCheckedChange:a=>X(a===!0),required:!0}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(c,{htmlFor:"rules",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Acepto el reglamento y deslinde de responsabilidad *"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Al inscribirme acepto las normas del evento y eximo de responsabilidad a los organizadores."," ",e.jsx(T,{to:"/reglamento",className:"text-primary hover:underline",children:"Leer reglamento completo"})]})]})]})})}),e.jsx("div",{className:"text-center",children:e.jsx(A,{type:"submit",size:"lg",className:"button-gradient shadow-button text-lg px-12 py-6",disabled:F||!R||!!q,children:F?e.jsx(e.Fragment,{children:"Procesando inscripción..."}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"mr-2 h-5 w-5"}),"Completar Inscripción"]})})})]})]})]})};export{Xe as default};
