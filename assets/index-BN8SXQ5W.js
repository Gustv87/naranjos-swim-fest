const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Index-Bf-vlYl_.js","assets/vendor-BSf5XApu.js","assets/card-BCSPAo1A.js","assets/radix-CKG2RIUU.js","assets/footer-Y_cviJm1.js","assets/capacity-indicator-DvaaBrVk.js","assets/badge-BwNN5mvw.js","assets/firebase-YSk2GZiI.js","assets/Inscripcion-B86e2UMZ.js","assets/label-BMVQs5FC.js","assets/Reglamento-B3FD-7Ti.js","assets/Resultados-B57cfZV_.js","assets/Admin-DKTwHTz-.js","assets/NotFound-C6whbZSG.js"])))=>i.map(i=>d[i]);
import{r as a,t as se,m as ne,j as s,X as ie,n as ae,p as ce,$ as le,Q as ue,q as de,B as me,w as pe,x as w,y as fe}from"./vendor-BSf5XApu.js";import{V as q,R as Q,A as X,C as G,T as K,D as W,P as ge,a as Y,b as he}from"./radix-CKG2RIUU.js";import{q as be,o as xe,c as U,a as ye,r as Se,s as ve,u as Te,g as we,b as B,d as Ne,e as A,f as Re,h as F,i as D}from"./firebase-YSk2GZiI.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(r){if(r.ep)return;r.ep=!0;const c=o(r);fetch(r.href,c)}})();const Ae="modulepreload",je=function(t){return"/"+t},z={},N=function(e,o,i){let r=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),g=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(o.map(b=>{if(b=je(b),b in z)return;z[b]=!0;const S=b.endsWith(".css"),I=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${I}`))return;const x=document.createElement("link");if(x.rel=S?"stylesheet":Ae,S||(x.as="script"),x.crossOrigin="",x.href=b,g&&x.setAttribute("nonce",g),document.head.appendChild(x),S)return new Promise((k,n)=>{x.addEventListener("load",k),x.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${b}`)))})}))}function c(l){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=l,window.dispatchEvent(g),!g.defaultPrevented)throw l}return r.then(l=>{for(const g of l||[])g.status==="rejected"&&c(g.reason);return e().catch(c)})},Ee=1,_e=1e6;let V=0;function Ie(){return V=(V+1)%Number.MAX_SAFE_INTEGER,V.toString()}const M=new Map,$=t=>{if(M.has(t))return;const e=setTimeout(()=>{M.delete(t),_({type:"REMOVE_TOAST",toastId:t})},_e);M.set(t,e)},Oe=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,Ee)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case"DISMISS_TOAST":{const{toastId:o}=e;return o?$(o):t.toasts.forEach(i=>{$(i.id)}),{...t,toasts:t.toasts.map(i=>i.id===o||o===void 0?{...i,open:!1}:i)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)}}},P=[];let C={toasts:[]};function _(t){C=Oe(C,t),P.forEach(e=>{e(C)})}function De({...t}){const e=Ie(),o=r=>_({type:"UPDATE_TOAST",toast:{...r,id:e}}),i=()=>_({type:"DISMISS_TOAST",toastId:e});return _({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:r=>{r||i()}}}),{id:e,dismiss:i,update:o}}function Pe(){const[t,e]=a.useState(C);return a.useEffect(()=>(P.push(e),()=>{const o=P.indexOf(e);o>-1&&P.splice(o,1)}),[t]),{...t,toast:De,dismiss:o=>_({type:"DISMISS_TOAST",toastId:o})}}function v(...t){return se(ne(t))}const Ce=ge,H=a.forwardRef(({className:t,...e},o)=>s.jsx(q,{ref:o,className:v("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));H.displayName=q.displayName;const ke=ae("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),J=a.forwardRef(({className:t,variant:e,...o},i)=>s.jsx(Q,{ref:i,className:v(ke({variant:e}),t),...o}));J.displayName=Q.displayName;const Le=a.forwardRef(({className:t,...e},o)=>s.jsx(X,{ref:o,className:v("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));Le.displayName=X.displayName;const Z=a.forwardRef(({className:t,...e},o)=>s.jsx(G,{ref:o,className:v("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:s.jsx(ie,{className:"h-4 w-4"})}));Z.displayName=G.displayName;const ee=a.forwardRef(({className:t,...e},o)=>s.jsx(K,{ref:o,className:v("text-sm font-semibold",t),...e}));ee.displayName=K.displayName;const te=a.forwardRef(({className:t,...e},o)=>s.jsx(W,{ref:o,className:v("text-sm opacity-90",t),...e}));te.displayName=W.displayName;function Be(){const{toasts:t}=Pe();return s.jsxs(Ce,{children:[t.map(function({id:e,title:o,description:i,action:r,...c}){return s.jsxs(J,{...c,children:[s.jsxs("div",{className:"grid gap-1",children:[o&&s.jsx(ee,{children:o}),i&&s.jsx(te,{children:i})]}),r,s.jsx(Z,{})]},e)}),s.jsx(H,{})]})}const Fe=({...t})=>{const{theme:e="system"}=ce();return s.jsx(le,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},Ve=he,Me=a.forwardRef(({className:t,sideOffset:e=4,...o},i)=>s.jsx(Y,{ref:i,sideOffset:e,className:v("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o}));Me.displayName=Y.displayName;const Ue=a.lazy(()=>N(()=>import("./Index-Bf-vlYl_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),ze=a.lazy(()=>N(()=>import("./Inscripcion-B86e2UMZ.js"),__vite__mapDeps([8,1,2,3,7,9,5]))),$e=a.lazy(()=>N(()=>import("./Reglamento-B3FD-7Ti.js"),__vite__mapDeps([10,1,2,3,6,7]))),qe=a.lazy(()=>N(()=>import("./Resultados-B57cfZV_.js"),__vite__mapDeps([11,1,2,3,4,6,7]))),Qe=a.lazy(()=>N(()=>import("./Admin-DKTwHTz-.js"),__vite__mapDeps([12,1,2,3,9,7]))),Xe=a.lazy(()=>N(()=>import("./NotFound-C6whbZSG.js"),__vite__mapDeps([13,1,4]))),Ge=new ue,Ke=()=>s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background text-sm text-muted-foreground",children:"Cargando contenido..."}),We=()=>s.jsx(de,{client:Ge,children:s.jsxs(Ve,{children:[s.jsx(Be,{}),s.jsx(Fe,{}),s.jsx(a.Suspense,{fallback:s.jsx(Ke,{}),children:s.jsx(me,{basename:"/",children:s.jsxs(pe,{children:[s.jsx(w,{path:"/",element:s.jsx(Ue,{})}),s.jsx(w,{path:"/inscripcion",element:s.jsx(ze,{})}),s.jsx(w,{path:"/reglamento",element:s.jsx($e,{})}),s.jsx(w,{path:"/resultados",element:s.jsx(qe,{})}),s.jsx(w,{path:"/admin",element:s.jsx(Qe,{})}),s.jsx(w,{path:"*",element:s.jsx(Xe,{})})]})})})]})}),E=100,j="registrations",oe=a.createContext(void 0),Ye=(t,e)=>{const o=e.createdAt;let i=new Date().toISOString();if(typeof o=="string")i=o;else if(o&&typeof o=="object"&&"toDate"in o)try{i=o.toDate().toISOString()}catch(r){console.warn("Failed to parse createdAt timestamp",r)}return{id:t,createdAt:i,dorsal:String(e.dorsal??""),status:e.status??"pending",nombre:String(e.nombre??""),dni:String(e.dni??""),nacimiento:String(e.nacimiento??""),email:String(e.email??""),telefono:String(e.telefono??""),club:String(e.club??""),distancia:String(e.distancia??""),sexo:String(e.sexo??""),categoria:String(e.categoria??""),emergenciaNombre:String(e.emergenciaNombre??""),emergenciaTel:String(e.emergenciaTel??""),medico:String(e.medico??""),banco:String(e.banco??""),monto:String(e.monto??""),referencia:String(e.referencia??""),tallaCamisa:String(e.tallaCamisa??""),comprobanteNombre:e.comprobanteNombre?String(e.comprobanteNombre):null,comprobanteUrl:e.comprobanteUrl?String(e.comprobanteUrl):null,comprobantePath:e.comprobantePath?String(e.comprobantePath):null,checkedInAt:(()=>{const r=e.checkedInAt;if(!r)return null;if(typeof r=="string")return r;if(typeof r=="object"&&"toDate"in r)try{return r.toDate().toISOString()}catch(c){return console.warn("Failed to parse checkedInAt timestamp",c),null}return null})(),checkedInBy:e.checkedInBy?String(e.checkedInBy):null,resultTime:e.resultTime?String(e.resultTime):null,resultSeconds:typeof e.resultSeconds=="number"?Number(e.resultSeconds):null,resultRecordedAt:(()=>{const r=e.resultRecordedAt;if(!r)return null;if(typeof r=="string")return r;if(typeof r=="object"&&"toDate"in r)try{return r.toDate().toISOString()}catch(c){return console.warn("Failed to parse resultRecordedAt timestamp",c),null}return null})(),resultRecordedBy:e.resultRecordedBy?String(e.resultRecordedBy):null}},He=t=>{if(!t.length)return"001";const e=t.map(i=>parseInt(i.dorsal,10)).filter(i=>Number.isFinite(i)).sort((i,r)=>r-i)[0]??0,o=Math.min(e+1,E);return String(o).padStart(3,"0")},Je=({children:t})=>{const[e,o]=a.useState([]),[i,r]=a.useState(!0),[c,l]=a.useState(null);a.useEffect(()=>{const n=be(U(A,j),xe("createdAt","desc")),m=ye(n,f=>{const p=f.docs.map(d=>Ye(d.id,d.data()));p.sort((d,h)=>new Date(h.createdAt).getTime()-new Date(d.createdAt).getTime()),o(p),r(!1),l(null)},f=>{console.error("Error al obtener inscripciones",f),l("No se pudieron cargar las inscripciones."),r(!1)});return()=>m()},[]);const g=a.useCallback(async n=>{if(e.length>=E)throw new Error("No hay cupos disponibles");const m=He(e),f=Date.now();let p=null,d=null,h=null,u;try{n.comprobanteFile&&(h=n.comprobanteFile.name,p=`comprobantes/${m}-${f}-${h}`,u=Se(ve,p),await Te(u,n.comprobanteFile),d=await we(u));const R={nombre:n.nombre,dni:n.dni,nacimiento:n.nacimiento,email:n.email,telefono:n.telefono,club:n.club,distancia:n.distancia,sexo:n.sexo,categoria:n.categoria,emergenciaNombre:n.emergenciaNombre,emergenciaTel:n.emergenciaTel,medico:n.medico,banco:n.banco,monto:n.monto,referencia:n.referencia,tallaCamisa:n.tallaCamisa,comprobanteNombre:h,comprobanteUrl:d,comprobantePath:p,checkedInAt:null,checkedInBy:null,dorsal:m,status:"pending",createdAt:B(),resultTime:null,resultSeconds:null,resultRecordedAt:null,resultRecordedBy:null};return{id:(await Ne(U(A,j),R)).id,...R,createdAt:new Date().toISOString()}}catch(R){if(u)try{await Re(u)}catch(T){console.warn("No se pudo limpiar el comprobante subido",T)}throw R}},[e]),b=a.useCallback(async(n,m,f={})=>{const p=F(A,j,n);await D(p,{status:m,...f})},[]),S=a.useCallback(async(n,m,f)=>{const p=F(A,j,n);m?await D(p,{checkedInAt:B(),checkedInBy:f}):await D(p,{checkedInAt:null,checkedInBy:null})},[]),I=a.useCallback(async(n,m,f)=>{const p=F(A,j,n);let d=null,h=null;if(m){const u=m.trim().toUpperCase();if(["NT","NS","DNS","DNF"].includes(u))h=u,d=null;else{const T=u.split(":").map(y=>y.trim());if(T.some(y=>y===""||Number.isNaN(Number(y))))throw new Error("Formato de tiempo inválido. Usa mm:ss, hh:mm:ss o los valores NT/NS.");const O=T.map(y=>Number(y));if(O.length===2){const[y,L]=O;d=y*60+L}else if(O.length===3){const[y,L,re]=O;d=y*3600+L*60+re}else throw new Error("Formato de tiempo inválido. Usa mm:ss, hh:mm:ss o los valores NT/NS.");if(!Number.isFinite(d)||d<0)throw new Error("El tiempo debe ser un número positivo.");h=T.join(":")}}else h=null;await D(p,{resultTime:h,resultSeconds:d,resultRecordedAt:m?B():null,resultRecordedBy:m?f:null})},[]),x=a.useMemo(()=>{const n=e.length,m=e.filter(u=>u.status==="pending").length,f=e.filter(u=>u.status==="validated").length,p=e.filter(u=>u.status==="rejected").length,d=e.filter(u=>u.checkedInAt!==null).length,h=Math.max(E-n,0);return{total:n,pending:m,validated:f,rejected:p,remaining:h,max:E,capacityFull:n>=E,checkedIn:d}},[e]),k=a.useMemo(()=>({registrations:e,stats:x,isLoading:i,error:c,addRegistration:g,updateRegistrationStatus:b,toggleCheckIn:S,updateRegistrationResult:I}),[e,x,i,c,g,b,S,I]);return s.jsx(oe.Provider,{value:k,children:t})},ot=()=>{const t=a.useContext(oe);if(!t)throw new Error("useRegistrations debe usarse dentro de RegistrationProvider");return t};fe(document.getElementById("root")).render(s.jsx(Je,{children:s.jsx(We,{})}));export{Pe as a,v as c,ot as u};
