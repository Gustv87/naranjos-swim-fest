const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Index-NxxfMevm.js","assets/vendor-CvKrFYBg.js","assets/card-Cjxxdy58.js","assets/button-PXHQ3is1.js","assets/radix-B4AvY2xt.js","assets/footer-CP3_GpQF.js","assets/capacity-indicator-BblQ598m.js","assets/badge-BtDIQfX8.js","assets/lago-yojoa-hero-AXIt0vXZ.js","assets/firebase-S-KbnFMc.js","assets/Inscripcion-CGTKM5up.js","assets/input-BXXAQ33C.js","assets/select-DvnaZnQZ.js","assets/Reglamento-BsZ4fy7I.js","assets/Resultados-BbEb3mWR.js","assets/Admin-D5ICv6yr.js","assets/NotFound-Cm0Tj6a-.js"])))=>i.map(i=>d[i]);
import{r as d,t as le,m as de,j as i,X as ue,n as me,p as fe,$ as pe,Q as ge,q as he,B as be,w as ye,x as j,y as we,z as xe,A as Se}from"./vendor-CvKrFYBg.js";import{V as K,R as W,A as H,C as J,T as Z,D as ee,P as ve,a as te,b as Ee}from"./radix-B4AvY2xt.js";import{q as V,o as Ne,c as k,a as Te,g as $,l as q,w as Q,r as Ae,s as Ie,u as Re,b as je,d as N,e as De,f as T,h as _e,i as B,j as _}from"./firebase-S-KbnFMc.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const m of n)if(m.type==="childList")for(const g of m.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&c(g)}).observe(document,{childList:!0,subtree:!0});function s(n){const m={};return n.integrity&&(m.integrity=n.integrity),n.referrerPolicy&&(m.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?m.credentials="include":n.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function c(n){if(n.ep)return;n.ep=!0;const m=s(n);fetch(n.href,m)}})();const Oe="modulepreload",Pe=function(t){return"/"+t},X={},D=function(e,s,c){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),x=(g==null?void 0:g.nonce)||(g==null?void 0:g.getAttribute("nonce"));n=Promise.allSettled(s.map(S=>{if(S=Pe(S),S in X)return;X[S]=!0;const I=S.endsWith(".css"),P=I?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${P}`))return;const v=document.createElement("link");if(v.rel=I?"stylesheet":Oe,I||(v.as="script"),v.crossOrigin="",v.href=S,x&&v.setAttribute("nonce",x),document.head.appendChild(v),I)return new Promise((C,F)=>{v.addEventListener("load",C),v.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${S}`)))})}))}function m(g){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=g,window.dispatchEvent(x),!x.defaultPrevented)throw g}return n.then(g=>{for(const x of g||[])x.status==="rejected"&&m(x.reason);return e().catch(m)})},Ce=1,ke=1e6;let M=0;function Be(){return M=(M+1)%Number.MAX_SAFE_INTEGER,M.toString()}const U=new Map,Y=t=>{if(U.has(t))return;const e=setTimeout(()=>{U.delete(t),O({type:"REMOVE_TOAST",toastId:t})},ke);U.set(t,e)},ze=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,Ce)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(s=>s.id===e.toast.id?{...s,...e.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=e;return s?Y(s):t.toasts.forEach(c=>{Y(c.id)}),{...t,toasts:t.toasts.map(c=>c.id===s||s===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==e.toastId)}}},z=[];let L={toasts:[]};function O(t){L=ze(L,t),z.forEach(e=>{e(L)})}function Le({...t}){const e=Be(),s=n=>O({type:"UPDATE_TOAST",toast:{...n,id:e}}),c=()=>O({type:"DISMISS_TOAST",toastId:e});return O({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:n=>{n||c()}}}),{id:e,dismiss:c,update:s}}function Fe(){const[t,e]=d.useState(L);return d.useEffect(()=>(z.push(e),()=>{const s=z.indexOf(e);s>-1&&z.splice(s,1)}),[t]),{...t,toast:Le,dismiss:s=>O({type:"DISMISS_TOAST",toastId:s})}}function R(...t){return le(de(t))}const Ve=ve,oe=d.forwardRef(({className:t,...e},s)=>i.jsx(K,{ref:s,className:R("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));oe.displayName=K.displayName;const Me=me("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),re=d.forwardRef(({className:t,variant:e,...s},c)=>i.jsx(W,{ref:c,className:R(Me({variant:e}),t),...s}));re.displayName=W.displayName;const Ue=d.forwardRef(({className:t,...e},s)=>i.jsx(H,{ref:s,className:R("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));Ue.displayName=H.displayName;const ne=d.forwardRef(({className:t,...e},s)=>i.jsx(J,{ref:s,className:R("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:i.jsx(ue,{className:"h-4 w-4"})}));ne.displayName=J.displayName;const se=d.forwardRef(({className:t,...e},s)=>i.jsx(Z,{ref:s,className:R("text-sm font-semibold",t),...e}));se.displayName=Z.displayName;const ie=d.forwardRef(({className:t,...e},s)=>i.jsx(ee,{ref:s,className:R("text-sm opacity-90",t),...e}));ie.displayName=ee.displayName;function $e(){const{toasts:t}=Fe();return i.jsxs(Ve,{children:[t.map(function({id:e,title:s,description:c,action:n,...m}){return i.jsxs(re,{...m,children:[i.jsxs("div",{className:"grid gap-1",children:[s&&i.jsx(se,{children:s}),c&&i.jsx(ie,{children:c})]}),n,i.jsx(ne,{})]},e)}),i.jsx(oe,{})]})}const qe=({...t})=>{const{theme:e="system"}=fe();return i.jsx(pe,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},Qe=Ee,Xe=d.forwardRef(({className:t,sideOffset:e=4,...s},c)=>i.jsx(te,{ref:c,sideOffset:e,className:R("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));Xe.displayName=te.displayName;const Ye=d.lazy(()=>D(()=>import("./Index-NxxfMevm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),Ge=d.lazy(()=>D(()=>import("./Inscripcion-CGTKM5up.js"),__vite__mapDeps([10,1,2,3,4,9,11,12,6]))),Ke=d.lazy(()=>D(()=>import("./Reglamento-BsZ4fy7I.js"),__vite__mapDeps([13,1,2,3,4,7,9]))),We=d.lazy(()=>D(()=>import("./Resultados-BbEb3mWR.js"),__vite__mapDeps([14,1,2,3,4,5,7,12,9])));d.lazy(()=>D(()=>import("./Admin-D5ICv6yr.js"),__vite__mapDeps([15,1,2,3,4,5,11,12,9])));const G=d.lazy(()=>D(()=>import("./NotFound-Cm0Tj6a-.js"),__vite__mapDeps([16,1,5,3,4,8,9]))),He=new ge,Je=()=>i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background text-sm text-muted-foreground",children:"Cargando contenido..."}),Ze=()=>{const t=we();return d.useEffect(()=>{const e=sessionStorage.getItem("redirectPath");e&&(sessionStorage.removeItem("redirectPath"),t(e,{replace:!0}))},[t]),null},et=()=>{const{pathname:t}=xe();return d.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[t]),null},tt=()=>i.jsx(he,{client:He,children:i.jsxs(Qe,{children:[i.jsx($e,{}),i.jsx(qe,{}),i.jsx(d.Suspense,{fallback:i.jsx(Je,{}),children:i.jsxs(be,{basename:"/",children:[i.jsx(Ze,{}),i.jsx(et,{}),i.jsxs(ye,{children:[i.jsx(j,{path:"/",element:i.jsx(Ye,{})}),i.jsx(j,{path:"/inscripcion",element:i.jsx(Ge,{})}),i.jsx(j,{path:"/reglamento",element:i.jsx(Ke,{})}),i.jsx(j,{path:"/resultados",element:i.jsx(We,{})}),i.jsx(j,{path:"/admin",element:i.jsx(G,{})}),i.jsx(j,{path:"*",element:i.jsx(G,{})})]})]})})]})}),ot=null,A="registrations",ae=d.createContext(void 0),rt=(t,e)=>{const s=e.createdAt;let c=new Date().toISOString();if(typeof s=="string")c=s;else if(s&&typeof s=="object"&&"toDate"in s)try{c=s.toDate().toISOString()}catch(n){console.warn("Failed to parse createdAt timestamp",n)}return{id:t,createdAt:c,dorsal:String(e.dorsal??""),status:e.status??"pending",nombre:String(e.nombre??""),dni:String(e.dni??""),nacimiento:String(e.nacimiento??""),email:String(e.email??""),telefono:String(e.telefono??""),club:String(e.club??""),distancia:String(e.distancia??""),sexo:String(e.sexo??""),categoria:String(e.categoria??""),emergenciaNombre:String(e.emergenciaNombre??""),emergenciaTel:String(e.emergenciaTel??""),medico:String(e.medico??""),banco:String(e.banco??""),monto:String(e.monto??""),referencia:String(e.referencia??""),tallaCamisa:String(e.tallaCamisa??""),comprobanteNombre:e.comprobanteNombre?String(e.comprobanteNombre):null,comprobanteUrl:e.comprobanteUrl?String(e.comprobanteUrl):null,comprobantePath:e.comprobantePath?String(e.comprobantePath):null,dniNormalized:e.dniNormalized?String(e.dniNormalized):null,checkedInAt:(()=>{const n=e.checkedInAt;if(!n)return null;if(typeof n=="string")return n;if(typeof n=="object"&&"toDate"in n)try{return n.toDate().toISOString()}catch(m){return console.warn("Failed to parse checkedInAt timestamp",m),null}return null})(),checkedInBy:e.checkedInBy?String(e.checkedInBy):null,resultTime:e.resultTime?String(e.resultTime):null,resultSeconds:typeof e.resultSeconds=="number"?Number(e.resultSeconds):null,resultRecordedAt:(()=>{const n=e.resultRecordedAt;if(!n)return null;if(typeof n=="string")return n;if(typeof n=="object"&&"toDate"in n)try{return n.toDate().toISOString()}catch(m){return console.warn("Failed to parse resultRecordedAt timestamp",m),null}return null})(),resultRecordedBy:e.resultRecordedBy?String(e.resultRecordedBy):null,updatedAt:(()=>{const n=e.updatedAt;if(!n)return null;if(typeof n=="string")return n;if(typeof n=="object"&&"toDate"in n)try{return n.toDate().toISOString()}catch(m){return console.warn("Failed to parse updatedAt timestamp",m),null}return null})(),updatedBy:e.updatedBy?String(e.updatedBy):null}},nt=t=>{if(!t.length)return"001";const s=(t.map(c=>parseInt(c.dorsal,10)).filter(c=>Number.isFinite(c)).sort((c,n)=>n-c)[0]??0)+1;return String(s).padStart(3,"0")},st=({children:t})=>{const[e,s]=d.useState([]),[c,n]=d.useState(!0),[m,g]=d.useState(null);d.useEffect(()=>{const a=V(k(T,A),Ne("createdAt","desc")),r=Te(a,h=>{const y=h.docs.map(f=>rt(f.id,f.data()));y.sort((f,l)=>{const u=parseInt(f.dorsal??"0",10),o=parseInt(l.dorsal??"0",10);return Number.isFinite(u)&&Number.isFinite(o)&&u!==o?u-o:new Date(f.createdAt).getTime()-new Date(l.createdAt).getTime()}),s(y),n(!1),g(null)},h=>{console.error("Error al obtener inscripciones",h),g("No se pudieron cargar las inscripciones."),n(!1)});return()=>r()},[]);const x=d.useCallback(async a=>{const r=a.dni.replace(/\D/g,"");if(r.length!==13)throw new Error("El DNI debe contener exactamente 13 dígitos sin guiones.");if(e.some(p=>p.dniNormalized?p.dniNormalized===r:p.dni.replace(/\D/g,"")===r))throw new Error("Este DNI ya tiene una inscripción registrada.");if(!(await $(V(k(T,A),Q("dniNormalized","==",r),q(1)))).empty)throw new Error("Este DNI ya tiene una inscripción registrada.");const f=nt(e),l=Date.now();let u=null,o=null,b=null,w;try{a.comprobanteFile&&(b=a.comprobanteFile.name,u=`comprobantes/${f}-${l}-${b}`,w=Ae(Ie,u),await Re(w,a.comprobanteFile),o=await je(w));const p={nombre:a.nombre,dni:r,dniNormalized:r,nacimiento:a.nacimiento,email:a.email,telefono:a.telefono,club:a.club,distancia:a.distancia,sexo:a.sexo,categoria:a.categoria,emergenciaNombre:a.emergenciaNombre,emergenciaTel:a.emergenciaTel,medico:a.medico,banco:a.banco,monto:a.monto,referencia:a.referencia,tallaCamisa:a.tallaCamisa,comprobanteNombre:b,comprobanteUrl:o,comprobantePath:u,checkedInAt:null,checkedInBy:null,dorsal:f,status:"pending",createdAt:N(),resultTime:null,resultSeconds:null,resultRecordedAt:null,resultRecordedBy:null,updatedAt:N(),updatedBy:null};return{id:(await De(k(T,A),p)).id,...p,createdAt:new Date().toISOString()}}catch(p){if(w)try{await _e(w)}catch(E){console.warn("No se pudo limpiar el comprobante subido",E)}throw p}},[e]),S=d.useCallback(async(a,r,h,y={})=>{const f=B(T,A,a);await _(f,{status:r,...y,updatedAt:N(),updatedBy:h})},[]),I=d.useCallback(async(a,r,h)=>{const y=B(T,A,a);r?await _(y,{checkedInAt:N(),checkedInBy:h,updatedAt:N(),updatedBy:h}):await _(y,{checkedInAt:null,checkedInBy:null,updatedAt:N(),updatedBy:h})},[]),P=d.useCallback(async(a,r,h)=>{const y=B(T,A,a);let f=null,l=null;if(r){const u=r.trim().toUpperCase();if(["NT","NS","DNS","DNF"].includes(u))l=u,f=null;else{const b=u.split(":").map(p=>p.trim());if(b.some(p=>p===""||Number.isNaN(Number(p))))throw new Error("Formato de tiempo inválido. Usa mm:ss, hh:mm:ss o los valores NT/NS.");const w=b.map(p=>Number(p));if(w.length===2){const[p,E]=w;f=p*60+E}else if(w.length===3){const[p,E,ce]=w;f=p*3600+E*60+ce}else throw new Error("Formato de tiempo inválido. Usa mm:ss, hh:mm:ss o los valores NT/NS.");if(!Number.isFinite(f)||f<0)throw new Error("El tiempo debe ser un número positivo.");l=b.join(":")}}else l=null;await _(y,{resultTime:l,resultSeconds:f,resultRecordedAt:r?N():null,resultRecordedBy:r?h:null,updatedAt:N(),updatedBy:h})},[]),v=d.useCallback(async(a,r,h)=>{const y=B(T,A,a),f=e.find(o=>o.id===a);if(!f)throw new Error("No se encontró el registro que intentas editar.");const l={},u=o=>typeof o=="string"?o.trim():void 0;if("nombre"in r){const o=u(r.nombre);if(!o)throw new Error("El nombre es obligatorio.");l.nombre=o}if("email"in r){const o=u(r.email);if(!o)throw new Error("El correo electrónico es obligatorio.");l.email=o}if("telefono"in r){const o=u(r.telefono);if(!o)throw new Error("El teléfono es obligatorio.");l.telefono=o}if("club"in r){const o=u(r.club);l.club=o??""}if("emergenciaNombre"in r&&(l.emergenciaNombre=u(r.emergenciaNombre)??""),"emergenciaTel"in r&&(l.emergenciaTel=u(r.emergenciaTel)??""),"medico"in r&&(l.medico=u(r.medico)??""),"banco"in r){const o=u(r.banco);if(!o)throw new Error("El banco o plataforma es obligatorio.");l.banco=o}if("monto"in r){const o=u(r.monto);if(!o)throw new Error("El monto es obligatorio.");l.monto=o}if("referencia"in r){const o=u(r.referencia);if(!o)throw new Error("La referencia o comprobante es obligatoria.");l.referencia=o}if("tallaCamisa"in r&&(l.tallaCamisa=u(r.tallaCamisa)??""),"dorsal"in r){const o=u(r.dorsal);if(!o)throw new Error("El dorsal es obligatorio.");const b=o.replace(/\D/g,"");if(!b)throw new Error("El dorsal debe ser numérico.");const w=b.padStart(3,"0");if(e.some(E=>E.id!==a&&E.dorsal===w))throw new Error("Este dorsal ya está asignado a otro participante.");l.dorsal=w}if("sexo"in r){const o=u(r.sexo);if(!o||!["M","F"].includes(o))throw new Error("Selecciona un sexo válido.");l.sexo=o}if("distancia"in r){const o=u(r.distancia);if(!o||!["800m","2km","5km"].includes(o))throw new Error("Selecciona una distancia válida.");l.distancia=o}if("categoria"in r&&(l.categoria=u(r.categoria)??""),"nacimiento"in r){const o=u(r.nacimiento);if(!o)throw new Error("La fecha de nacimiento es obligatoria.");l.nacimiento=o}if("dni"in r){const o=u(r.dni);if(!o)throw new Error("El DNI es obligatorio.");const b=o.replace(/\D/g,"");if(b.length!==13)throw new Error("El DNI debe contener exactamente 13 dígitos sin guiones.");if(b!==f.dniNormalized&&(await $(V(k(T,A),Q("dniNormalized","==",b),q(1)))).docs.some(E=>E.id!==a))throw new Error("Este DNI ya tiene una inscripción registrada.");l.dni=b,l.dniNormalized=b}Object.keys(l).length!==0&&await _(y,{...l,updatedAt:N(),updatedBy:h})},[e]),C=d.useMemo(()=>{const a=e.length,r=e.filter(o=>o.status==="pending").length,h=e.filter(o=>o.status==="validated").length,y=e.filter(o=>o.status==="rejected").length,f=e.filter(o=>o.checkedInAt!==null).length;return{total:a,pending:r,validated:h,rejected:y,remaining:null,max:ot,capacityFull:!1,checkedIn:f}},[e]),F=d.useMemo(()=>({registrations:e,stats:C,isLoading:c,error:m,addRegistration:x,updateRegistrationStatus:S,toggleCheckIn:I,updateRegistrationResult:P,updateRegistrationData:v}),[e,C,c,m,x,S,I,P,v]);return i.jsx(ae.Provider,{value:F,children:t})},lt=()=>{const t=d.useContext(ae);if(!t)throw new Error("useRegistrations debe usarse dentro de RegistrationProvider");return t};Se(document.getElementById("root")).render(i.jsx(st,{children:i.jsx(tt,{})}));export{Fe as a,R as c,lt as u};
