import{r as x,j as e,G as le,I as U,L as F,J as B,K as de,D as me}from"./vendor-BlfV3RTz.js";import{N as V,C as u,a as h,b as g,c as R,d as j}from"./card-BUSoIunq.js";import{B as k}from"./button-g7unuLHQ.js";import{F as ue}from"./firebase-BIHwqxFo.js";import{I as m}from"./input-bWQMKSoR.js";import{L as n,S,a as D,b as T,c as A,d as f}from"./select-D7pPCpPI.js";import{c as P,a as xe,u as pe}from"./index-DexQnILn.js";import{c as W,d as he}from"./radix-C6NXPyZw.js";import{C as Q}from"./capacity-indicator-DdgblkOH.js";const ee=x.forwardRef(({className:t,...v},p)=>e.jsx("textarea",{className:P("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:p,...v}));ee.displayName="Textarea";const ae=x.forwardRef(({className:t,...v},p)=>e.jsx(W,{ref:p,className:P("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...v,children:e.jsx(he,{className:P("flex items-center justify-center text-current"),children:e.jsx(le,{className:"h-4 w-4"})})}));ae.displayName=W.displayName;const _=15,ge=_*1024*1024,Fe=()=>{x.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const{toast:t}=xe(),{addRegistration:v,stats:p,isLoading:se}=pe(),[Y,z]=x.useState(!1),[I,O]=x.useState(!1),X=p.total,G=p.max,H=new Date<new Date("2025-10-07T23:59:59-06:00"),L=p.capacityFull,ie=se,[r,c]=x.useState({nombre:"",dni:"",nacimiento:"",email:"",telefono:"",club:"",distancia:"",sexo:"",emergenciaNombre:"",emergenciaTel:"",medico:"",banco:"",monto:"",referencia:"",tallaCamisa:"",comprobante:null}),[M,d]=x.useState(""),[J,N]=x.useState(""),re=["BAC Honduras"],te=["12","14","16","XS","S","M","L","XL","XXL"],y={"800m":9,"2km":15,"5km":15},E=new Date("2025-10-12"),C=a=>{if(!a)return null;const s=new Date(a);if(Number.isNaN(s.getTime()))return null;let i=E.getFullYear()-s.getFullYear();return E.getMonth()>s.getMonth()||E.getMonth()===s.getMonth()&&E.getDate()>=s.getDate()||(i-=1),i},$=(a,s)=>{if(!a||!s)return"";const i=C(a);return i===null?"":s==="800m"?i>=9&&i<=10?"Infantiles A (9-10)":i>=11&&i<=12?"Infantiles B (11-12)":i>=13&&i<=14?"Juveniles A (13-14)":i>=15?"Masters":"":i>=15&&i<=17?"Juveniles B (15-17)":i>=18&&i<=30?"20-30":i>=31&&i<=40?"30-40":"40+"},Z=(a,s)=>{if(!a){d("");return}const i=C(a);if(i===null){d("");return}if(i<9){d("La edad mínima para participar es 9 años.");return}if(i<=10&&s&&s!=="800m"){d("Con 9 y 10 años solo puedes inscribirte en 800 metros.");return}const o=s?y[s]??9:9;if(i<o){d("Esta edad no es permitida para participar.");return}d("")},ne=a=>{c(s=>{const i={...s,nacimiento:a},o=C(a);if(o!==null){if(o<9)i.distancia="";else if(i.distancia)if(o<=10&&i.distancia!=="800m")i.distancia="";else{const w=y[i.distancia]??9;o<w&&(i.distancia="")}}return Z(i.nacimiento,i.distancia),i})},ce=a=>{var i;const s=((i=a.target.files)==null?void 0:i[0])??null;if(s&&s.size>ge){t({variant:"destructive",title:"Archivo muy pesado",description:`El comprobante supera los ${_} MB permitidos. Reduce el tamaño o utiliza un formato más liviano.`}),a.target.value="";return}c(o=>({...o,comprobante:s}))},oe=async a=>{if(a.preventDefault(),!I){t({variant:"destructive",title:"Error",description:"Debes aceptar el reglamento para continuar"});return}if(!r.tallaCamisa){t({variant:"destructive",title:"Error",description:"Selecciona la talla de camisa."});return}const s=r.dni.replace(/\D/g,"");if(s.length!==13){const l="El número de identidad debe tener 13 dígitos sin guiones.";N(l),t({variant:"destructive",title:"DNI inválido",description:l});return}N("");const i=C(r.nacimiento),o=r.distancia;if(i===null){t({variant:"destructive",title:"Edad no permitida",description:"Verifica tu fecha de nacimiento."});return}if(i<9){t({variant:"destructive",title:"Edad no permitida",description:"La edad mínima para participar es 9 años."}),d("La edad mínima para participar es 9 años.");return}if(i<=10&&o&&o!=="800m"){t({variant:"destructive",title:"Edad no permitida",description:"Con 9 y 10 años solo puedes inscribirte en la distancia de 800 metros."}),d("Con 9 y 10 años solo puedes inscribirte en 800 metros.");return}const w=o?y[o]??9:9;if(i<w){t({variant:"destructive",title:"Edad no permitida",description:`La edad mínima para ${o==="800m"?"800 metros":o==="2km"?"2 kilómetros":o==="5km"?"5 kilómetros":"esta distancia"} es de ${w} años.`}),d("Esta edad no es permitida para participar.");return}if(d(""),!H){t({variant:"destructive",title:"Inscripciones cerradas",description:"El período de inscripciones ha terminado"});return}if(!navigator.onLine){t({variant:"destructive",title:"Sin conexión",description:"Verifica tu conexión a internet antes de continuar."});return}if(ie){t({title:"Cargando información",description:"Espera a que se actualice la disponibilidad de cupos antes de continuar."});return}if(L){t({variant:"destructive",title:"Cupo agotado",description:"Ya no hay cupos disponibles para este evento"});return}z(!0);try{const l=$(r.nacimiento,r.distancia);if(!l){t({variant:"destructive",title:"Error",description:"No pudimos determinar tu categoría. Verifica tu fecha de nacimiento y distancia."});return}const b=await v({nombre:r.nombre.trim(),dni:s,nacimiento:r.nacimiento,email:r.email.trim(),telefono:r.telefono.trim(),club:r.club.trim(),distancia:r.distancia,sexo:r.sexo,categoria:l,emergenciaNombre:r.emergenciaNombre.trim(),emergenciaTel:r.emergenciaTel.trim(),medico:r.medico.trim(),banco:r.banco,monto:r.monto.trim(),referencia:r.referencia.trim(),tallaCamisa:r.tallaCamisa,comprobanteFile:r.comprobante});t({title:"¡Inscripción registrada!",description:"Te contactaremos para validar tu pago."}),c({nombre:"",dni:"",nacimiento:"",email:"",telefono:"",club:"",distancia:"",sexo:"",emergenciaNombre:"",emergenciaTel:"",medico:"",banco:"",monto:"",referencia:"",tallaCamisa:"",comprobante:null}),d(""),N(""),O(!1)}catch(l){let b="No se pudo procesar tu inscripción. Intenta nuevamente.";l instanceof ue?l.code.includes("network")||l.code==="unavailable"?b="No pudimos conectar con el servidor. Verifica tu conexión a internet e intenta nuevamente.":l.code==="storage/unauthorized"?b="No tienes permisos para subir el comprobante. Contacta al administrador.":b=l.message:l instanceof Error&&(l.message.toLowerCase().includes("dni")&&N(l.message),b=l.message==="No hay cupos disponibles"?"Ya no hay cupos disponibles para este evento.":l.message),t({variant:"destructive",title:"Error",description:b})}finally{z(!1)}},K=C(r.nacimiento),q=a=>{const s=y[a]??9;return K!==null&&K<s};return!H&&!L?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(V,{}),e.jsx("div",{className:"max-w-2xl mx-auto px-4 py-16",children:e.jsxs(u,{className:"text-center",children:[e.jsxs(h,{children:[e.jsx(U,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),e.jsx(g,{className:"text-2xl",children:"Inscripciones Cerradas"}),e.jsx(R,{className:"text-lg",children:"El período de inscripciones terminó el 7 de octubre de 2025"})]}),e.jsx(j,{children:e.jsx(F,{to:"/",children:e.jsxs(k,{children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Volver al inicio"]})})})]})})]}):L?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(V,{}),e.jsx("div",{className:"max-w-2xl mx-auto px-4 py-16",children:e.jsxs(u,{className:"text-center",children:[e.jsxs(h,{children:[e.jsx(U,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),e.jsx(g,{className:"text-2xl",children:"Cupo Agotado"}),e.jsx(R,{className:"text-lg",children:"Ya no hay cupos disponibles para este evento"})]}),e.jsxs(j,{children:[e.jsx(Q,{current:X,max:G,className:"mb-6"}),e.jsx(F,{to:"/",children:e.jsxs(k,{children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Volver al inicio"]})})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(V,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx(F,{to:"/",children:e.jsxs(k,{variant:"ghost",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Volver al inicio"]})})}),e.jsx(u,{className:"card-gradient shadow-card mb-8",children:e.jsxs(h,{className:"text-center",children:[e.jsx(g,{className:"text-3xl text-primary",children:"Formulario de Inscripción"}),e.jsx(R,{className:"text-lg",children:"Completa todos los campos para inscribirte al Encuentro de Aguas Abiertas Los Naranjos"}),e.jsx(Q,{current:X,max:G,className:"mt-4"})]})}),e.jsxs("form",{onSubmit:oe,className:"space-y-8",children:[e.jsxs(u,{className:"card-gradient shadow-card",children:[e.jsx(h,{children:e.jsx(g,{className:"text-xl text-primary",children:"Datos Personales"})}),e.jsxs(j,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"nombre",children:"Nombre Completo *"}),e.jsx(m,{id:"nombre",value:r.nombre,onChange:a=>c(s=>({...s,nombre:a.target.value})),required:!0,placeholder:"Tu nombre completo"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"dni",children:"Identidad/DNI *"}),e.jsx(m,{id:"dni",value:r.dni,onChange:a=>{const s=a.target.value.replace(/\D/g,"").slice(0,13);N(""),c(i=>({...i,dni:s}))},required:!0,placeholder:"0801199012345",inputMode:"numeric",maxLength:13}),J&&e.jsx("p",{className:"text-sm text-destructive",children:J})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"nacimiento",children:"Fecha de Nacimiento *"}),e.jsx(m,{id:"nacimiento",type:"date",value:r.nacimiento,onChange:a=>ne(a.target.value),required:!0}),M&&e.jsx("p",{className:"text-sm text-destructive",children:M})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"tallaCamisa",children:"Talla de Camisa *"}),e.jsxs(S,{value:r.tallaCamisa,onValueChange:a=>c(s=>({...s,tallaCamisa:a})),children:[e.jsx(D,{id:"tallaCamisa",children:e.jsx(T,{placeholder:"Selecciona la talla"})}),e.jsx(A,{children:te.map(a=>e.jsx(f,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"email",children:"Email *"}),e.jsx(m,{id:"email",type:"email",value:r.email,onChange:a=>c(s=>({...s,email:a.target.value})),required:!0,placeholder:"tu@email.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"telefono",children:"Teléfono *"}),e.jsx(m,{id:"telefono",value:r.telefono,onChange:a=>c(s=>({...s,telefono:a.target.value})),required:!0,placeholder:"9999-9999"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"club",children:"Club/Equipo *"}),e.jsx(m,{id:"club",value:r.club,onChange:a=>c(s=>({...s,club:a.target.value})),required:!0,placeholder:"Nombre de tu club o equipo"})]})]})]}),e.jsxs(u,{className:"card-gradient shadow-card",children:[e.jsx(h,{children:e.jsx(g,{className:"text-xl text-primary",children:"Datos de Competencia"})}),e.jsxs(j,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"distancia",children:"Distancia *"}),e.jsxs(S,{value:r.distancia,onValueChange:a=>c(s=>{const i={...s,distancia:a};return Z(i.nacimiento,i.distancia),i}),required:!0,children:[e.jsx(D,{children:e.jsx(T,{placeholder:"Selecciona la distancia"})}),e.jsxs(A,{children:[e.jsx(f,{value:"800m",disabled:q("800m"),children:"800 metros"}),e.jsx(f,{value:"2km",disabled:q("2km"),children:"2 kilómetros"}),e.jsx(f,{value:"5km",disabled:q("5km"),children:"5 kilómetros"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"sexo",children:"Sexo *"}),e.jsxs(S,{value:r.sexo,onValueChange:a=>c(s=>({...s,sexo:a})),required:!0,children:[e.jsx(D,{children:e.jsx(T,{placeholder:"Selecciona tu sexo"})}),e.jsxs(A,{children:[e.jsx(f,{value:"F",children:"Femenino"}),e.jsx(f,{value:"M",children:"Masculino"})]})]})]}),r.distancia&&r.nacimiento&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{children:"Categoría"}),e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx("span",{className:"font-semibold text-primary",children:$(r.nacimiento,r.distancia)})})]})]})]}),e.jsxs(u,{className:"card-gradient shadow-card",children:[e.jsx(h,{children:e.jsx(g,{className:"text-xl text-primary",children:"Contacto de Emergencia"})}),e.jsxs(j,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"emergenciaNombre",children:"Nombre *"}),e.jsx(m,{id:"emergenciaNombre",value:r.emergenciaNombre,onChange:a=>c(s=>({...s,emergenciaNombre:a.target.value})),required:!0,placeholder:"Nombre del contacto"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"emergenciaTel",children:"Teléfono *"}),e.jsx(m,{id:"emergenciaTel",value:r.emergenciaTel,onChange:a=>c(s=>({...s,emergenciaTel:a.target.value})),required:!0,placeholder:"9999-9999"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(n,{htmlFor:"medico",children:"Condición médica relevante (opcional)"}),e.jsx(ee,{id:"medico",value:r.medico,onChange:a=>c(s=>({...s,medico:a.target.value})),placeholder:"Medicamentos, alergias, condiciones médicas importantes...",rows:3})]})]})]}),e.jsxs(u,{className:"card-gradient shadow-card",children:[e.jsx(h,{children:e.jsx(g,{className:"text-xl text-primary",children:"Información de Pago"})}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"banco",children:"Banco/Plataforma *"}),e.jsxs(S,{value:r.banco,onValueChange:a=>c(s=>({...s,banco:a})),required:!0,children:[e.jsx(D,{children:e.jsx(T,{placeholder:"Selecciona el banco"})}),e.jsx(A,{children:re.map(a=>e.jsx(f,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"monto",children:"Monto (L) *"}),e.jsx(m,{id:"monto",type:"number",step:"0.01",value:r.monto,onChange:a=>c(s=>({...s,monto:a.target.value})),required:!0,placeholder:"300.00"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(n,{htmlFor:"referencia",children:"Número de referencia/transacción *"}),e.jsx(m,{id:"referencia",value:r.referencia,onChange:a=>c(s=>({...s,referencia:a.target.value})),required:!0,placeholder:"Número de confirmación del pago"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"comprobante",children:["Comprobante de pago * (PDF, JPG, PNG - máx. ",_,"MB)"]}),e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center",children:[e.jsx(de,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx(m,{id:"comprobante",type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:ce,required:!0,className:"max-w-sm mx-auto"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Sube tu comprobante de pago"})]})]})]})]}),e.jsx(u,{className:"card-gradient shadow-card",children:e.jsx(j,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ae,{id:"rules",checked:I,onCheckedChange:a=>O(a===!0),required:!0}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(n,{htmlFor:"rules",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Acepto el reglamento y deslinde de responsabilidad *"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Al inscribirme acepto las normas del evento y eximo de responsabilidad a los organizadores."," ",e.jsx(F,{to:"/reglamento",className:"text-primary hover:underline",children:"Leer reglamento completo"})]})]})]})})}),e.jsx("div",{className:"text-center",children:e.jsx(k,{type:"submit",size:"lg",className:"button-gradient shadow-button text-lg px-12 py-6",disabled:Y||!I||!!M,children:Y?e.jsx(e.Fragment,{children:"Procesando inscripción..."}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"mr-2 h-5 w-5"}),"Completar Inscripción"]})})})]})]})]})};export{Fe as default};
