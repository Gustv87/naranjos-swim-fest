const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Index-Co7BaP6s.js","assets/vendor-CXadzovC.js","assets/card-BDWSsjl3.js","assets/radix-C1F2jKhp.js","assets/footer-BmELRPhz.js","assets/capacity-indicator-BgbAPUZ2.js","assets/badge-CwgFMbF7.js","assets/firebase-DUZ5dv6p.js","assets/Inscripcion-D5u19Uhj.js","assets/label-BMnDA5ef.js","assets/Reglamento-BXNjFKYf.js","assets/Admin-CrF_J7Rd.js","assets/NotFound-BF2PeSss.js"])))=>i.map(i=>d[i]);
import{r as a,t as Z,m as ee,j as s,X as te,n as oe,p as re,$ as se,Q as ne,q as ie,B as ae,w as ce,x as S,y as le}from"./vendor-CXadzovC.js";import{V as F,R as U,A as $,C as z,T as q,D as Q,P as de,a as X,b as ue}from"./radix-C1F2jKhp.js";import{q as me,o as pe,c as k,a as fe,r as ge,s as he,u as xe,g as be,b as L,d as ye,e as E,f as ve,h as B,i as O}from"./firebase-DUZ5dv6p.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(r){if(r.ep)return;r.ep=!0;const c=o(r);fetch(r.href,c)}})();const Se="modulepreload",we=function(t){return"/"+t},M={},A=function(e,o,n){let r=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),m=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(o.map(f=>{if(f=we(f),f in M)return;M[f]=!0;const b=f.endsWith(".css"),j=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${j}`))return;const h=document.createElement("link");if(h.rel=b?"stylesheet":Se,b||(h.as="script"),h.crossOrigin="",h.href=f,m&&h.setAttribute("nonce",m),document.head.appendChild(h),b)return new Promise((i,p)=>{h.addEventListener("load",i),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${f}`)))})}))}function c(l){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=l,window.dispatchEvent(m),!m.defaultPrevented)throw l}return r.then(l=>{for(const m of l||[])m.status==="rejected"&&c(m.reason);return e().catch(c)})},Te=1,Ae=1e6;let P=0;function je(){return P=(P+1)%Number.MAX_SAFE_INTEGER,P.toString()}const D=new Map,V=t=>{if(D.has(t))return;const e=setTimeout(()=>{D.delete(t),T({type:"REMOVE_TOAST",toastId:t})},Ae);D.set(t,e)},Ne=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,Te)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case"DISMISS_TOAST":{const{toastId:o}=e;return o?V(o):t.toasts.forEach(n=>{V(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===o||o===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)}}},R=[];let _={toasts:[]};function T(t){_=Ne(_,t),R.forEach(e=>{e(_)})}function Ee({...t}){const e=je(),o=r=>T({type:"UPDATE_TOAST",toast:{...r,id:e}}),n=()=>T({type:"DISMISS_TOAST",toastId:e});return T({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:r=>{r||n()}}}),{id:e,dismiss:n,update:o}}function Ie(){const[t,e]=a.useState(_);return a.useEffect(()=>(R.push(e),()=>{const o=R.indexOf(e);o>-1&&R.splice(o,1)}),[t]),{...t,toast:Ee,dismiss:o=>T({type:"DISMISS_TOAST",toastId:o})}}function v(...t){return Z(ee(t))}const Re=de,G=a.forwardRef(({className:t,...e},o)=>s.jsx(F,{ref:o,className:v("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));G.displayName=F.displayName;const _e=oe("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),K=a.forwardRef(({className:t,variant:e,...o},n)=>s.jsx(U,{ref:n,className:v(_e({variant:e}),t),...o}));K.displayName=U.displayName;const Oe=a.forwardRef(({className:t,...e},o)=>s.jsx($,{ref:o,className:v("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));Oe.displayName=$.displayName;const W=a.forwardRef(({className:t,...e},o)=>s.jsx(z,{ref:o,className:v("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:s.jsx(te,{className:"h-4 w-4"})}));W.displayName=z.displayName;const Y=a.forwardRef(({className:t,...e},o)=>s.jsx(q,{ref:o,className:v("text-sm font-semibold",t),...e}));Y.displayName=q.displayName;const H=a.forwardRef(({className:t,...e},o)=>s.jsx(Q,{ref:o,className:v("text-sm opacity-90",t),...e}));H.displayName=Q.displayName;function Pe(){const{toasts:t}=Ie();return s.jsxs(Re,{children:[t.map(function({id:e,title:o,description:n,action:r,...c}){return s.jsxs(K,{...c,children:[s.jsxs("div",{className:"grid gap-1",children:[o&&s.jsx(Y,{children:o}),n&&s.jsx(H,{children:n})]}),r,s.jsx(W,{})]},e)}),s.jsx(G,{})]})}const De=({...t})=>{const{theme:e="system"}=re();return s.jsx(se,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},Ce=ue,ke=a.forwardRef(({className:t,sideOffset:e=4,...o},n)=>s.jsx(X,{ref:n,sideOffset:e,className:v("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o}));ke.displayName=X.displayName;const Le=a.lazy(()=>A(()=>import("./Index-Co7BaP6s.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Be=a.lazy(()=>A(()=>import("./Inscripcion-D5u19Uhj.js"),__vite__mapDeps([8,1,2,3,7,9,5]))),Me=a.lazy(()=>A(()=>import("./Reglamento-BXNjFKYf.js"),__vite__mapDeps([10,1,2,3,6,7]))),Ve=a.lazy(()=>A(()=>import("./Admin-CrF_J7Rd.js"),__vite__mapDeps([11,1,2,3,9,7]))),Fe=a.lazy(()=>A(()=>import("./NotFound-BF2PeSss.js"),__vite__mapDeps([12,1,4]))),Ue=new ne,$e=()=>s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background text-sm text-muted-foreground",children:"Cargando contenido..."}),ze=()=>s.jsx(ie,{client:Ue,children:s.jsxs(Ce,{children:[s.jsx(Pe,{}),s.jsx(De,{}),s.jsx(a.Suspense,{fallback:s.jsx($e,{}),children:s.jsx(ae,{basename:"/",children:s.jsxs(ce,{children:[s.jsx(S,{path:"/",element:s.jsx(Le,{})}),s.jsx(S,{path:"/inscripcion",element:s.jsx(Be,{})}),s.jsx(S,{path:"/reglamento",element:s.jsx(Me,{})}),s.jsx(S,{path:"/admin",element:s.jsx(Ve,{})}),s.jsx(S,{path:"*",element:s.jsx(Fe,{})})]})})})]})}),w=100,I="registrations",J=a.createContext(void 0),qe=(t,e)=>{const o=e.createdAt;let n=new Date().toISOString();if(typeof o=="string")n=o;else if(o&&typeof o=="object"&&"toDate"in o)try{n=o.toDate().toISOString()}catch(r){console.warn("Failed to parse createdAt timestamp",r)}return{id:t,createdAt:n,dorsal:String(e.dorsal??""),status:e.status??"pending",nombre:String(e.nombre??""),dni:String(e.dni??""),nacimiento:String(e.nacimiento??""),email:String(e.email??""),telefono:String(e.telefono??""),club:String(e.club??""),distancia:String(e.distancia??""),sexo:String(e.sexo??""),categoria:String(e.categoria??""),emergenciaNombre:String(e.emergenciaNombre??""),emergenciaTel:String(e.emergenciaTel??""),medico:String(e.medico??""),banco:String(e.banco??""),monto:String(e.monto??""),referencia:String(e.referencia??""),tallaCamisa:String(e.tallaCamisa??""),comprobanteNombre:e.comprobanteNombre?String(e.comprobanteNombre):null,comprobanteUrl:e.comprobanteUrl?String(e.comprobanteUrl):null,comprobantePath:e.comprobantePath?String(e.comprobantePath):null,checkedInAt:(()=>{const r=e.checkedInAt;if(!r)return null;if(typeof r=="string")return r;if(typeof r=="object"&&"toDate"in r)try{return r.toDate().toISOString()}catch(c){return console.warn("Failed to parse checkedInAt timestamp",c),null}return null})(),checkedInBy:e.checkedInBy?String(e.checkedInBy):null}},Qe=t=>{if(!t.length)return"001";const e=t.map(n=>parseInt(n.dorsal,10)).filter(n=>Number.isFinite(n)).sort((n,r)=>r-n)[0]??0,o=Math.min(e+1,w);return String(o).padStart(3,"0")},Xe=({children:t})=>{const[e,o]=a.useState([]),[n,r]=a.useState(!0),[c,l]=a.useState(null);a.useEffect(()=>{const i=me(k(E,I),pe("createdAt","desc")),p=fe(i,g=>{const d=g.docs.map(x=>qe(x.id,x.data()));d.sort((x,y)=>new Date(y.createdAt).getTime()-new Date(x.createdAt).getTime()),o(d),r(!1),l(null)},g=>{console.error("Error al obtener inscripciones",g),l("No se pudieron cargar las inscripciones."),r(!1)});return()=>p()},[]);const m=a.useCallback(async i=>{if(e.length>=w)throw new Error("No hay cupos disponibles");const p=Qe(e),g=Date.now();let d=null,x=null,y=null,u;try{i.comprobanteFile&&(y=i.comprobanteFile.name,d=`comprobantes/${p}-${g}-${y}`,u=ge(he,d),await xe(u,i.comprobanteFile),x=await be(u));const N={nombre:i.nombre,dni:i.dni,nacimiento:i.nacimiento,email:i.email,telefono:i.telefono,club:i.club,distancia:i.distancia,sexo:i.sexo,categoria:i.categoria,emergenciaNombre:i.emergenciaNombre,emergenciaTel:i.emergenciaTel,medico:i.medico,banco:i.banco,monto:i.monto,referencia:i.referencia,tallaCamisa:i.tallaCamisa,comprobanteNombre:y,comprobanteUrl:x,comprobantePath:d,checkedInAt:null,checkedInBy:null,dorsal:p,status:"pending",createdAt:L()};return{id:(await ye(k(E,I),N)).id,...N,createdAt:new Date().toISOString()}}catch(N){if(u)try{await ve(u)}catch(C){console.warn("No se pudo limpiar el comprobante subido",C)}throw N}},[e]),f=a.useCallback(async(i,p,g={})=>{const d=B(E,I,i);await O(d,{status:p,...g})},[]),b=a.useCallback(async(i,p,g)=>{const d=B(E,I,i);p?await O(d,{checkedInAt:L(),checkedInBy:g}):await O(d,{checkedInAt:null,checkedInBy:null})},[]),j=a.useMemo(()=>{const i=e.length,p=e.filter(u=>u.status==="pending").length,g=e.filter(u=>u.status==="validated").length,d=e.filter(u=>u.status==="rejected").length,x=e.filter(u=>u.checkedInAt!==null).length,y=Math.max(w-i,0);return{total:i,pending:p,validated:g,rejected:d,remaining:y,max:w,capacityFull:i>=w,checkedIn:x}},[e]),h=a.useMemo(()=>({registrations:e,stats:j,isLoading:n,error:c,addRegistration:m,updateRegistrationStatus:f,toggleCheckIn:b}),[e,j,n,c,m,f,b]);return s.jsx(J.Provider,{value:h,children:t})},Ye=()=>{const t=a.useContext(J);if(!t)throw new Error("useRegistrations debe usarse dentro de RegistrationProvider");return t};le(document.getElementById("root")).render(s.jsx(Xe,{children:s.jsx(ze,{})}));export{Ie as a,v as c,Ye as u};
