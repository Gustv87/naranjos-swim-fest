const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Index-DoFsyQdd.js","assets/vendor-BlfV3RTz.js","assets/card-BUSoIunq.js","assets/button-g7unuLHQ.js","assets/radix-C6NXPyZw.js","assets/footer-ChGT9lhB.js","assets/capacity-indicator-DdgblkOH.js","assets/badge-BAvpKA_7.js","assets/lago-yojoa-hero-AXIt0vXZ.js","assets/firebase-BIHwqxFo.js","assets/Inscripcion-CCUjht9K.js","assets/input-bWQMKSoR.js","assets/select-D7pPCpPI.js","assets/Reglamento-NVh1EWIl.js","assets/Resultados-Cj4QiQ2v.js","assets/Admin-CoeIwGEW.js","assets/NotFound-CkVNGuxK.js"])))=>i.map(i=>d[i]);
import{r as u,t as le,m as de,j as i,X as ue,n as me,p as fe,$ as pe,Q as ge,q as he,B as be,w as we,x as j,y as ye,z as xe,A as Se}from"./vendor-BlfV3RTz.js";import{V as W,R as Y,A as H,C as J,T as Z,D as ee,P as ve,a as te,b as Ee}from"./radix-C6NXPyZw.js";import{q as M,o as Ne,c as B,a as Te,g as q,l as Q,w as X,r as Ae,s as Re,u as Ie,b as je,d as N,e as De,f as T,h as _e,i as z,j as _}from"./firebase-BIHwqxFo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const m of r)if(m.type==="childList")for(const g of m.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function n(r){const m={};return r.integrity&&(m.integrity=r.integrity),r.referrerPolicy&&(m.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?m.credentials="include":r.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(r){if(r.ep)return;r.ep=!0;const m=n(r);fetch(r.href,m)}})();const Oe="modulepreload",Pe=function(t){return"/"+t},G={},D=function(e,n,l){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),x=(g==null?void 0:g.nonce)||(g==null?void 0:g.getAttribute("nonce"));r=Promise.allSettled(n.map(S=>{if(S=Pe(S),S in G)return;G[S]=!0;const R=S.endsWith(".css"),C=R?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${C}`))return;const v=document.createElement("link");if(v.rel=R?"stylesheet":Oe,R||(v.as="script"),v.crossOrigin="",v.href=S,x&&v.setAttribute("nonce",x),document.head.appendChild(v),R)return new Promise((k,V)=>{v.addEventListener("load",k),v.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${S}`)))})}))}function m(g){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=g,window.dispatchEvent(x),!x.defaultPrevented)throw g}return r.then(g=>{for(const x of g||[])x.status==="rejected"&&m(x.reason);return e().catch(m)})},Ce=1,ke=1e6;let U=0;function Be(){return U=(U+1)%Number.MAX_SAFE_INTEGER,U.toString()}const $=new Map,K=t=>{if($.has(t))return;const e=setTimeout(()=>{$.delete(t),P({type:"REMOVE_TOAST",toastId:t})},ke);$.set(t,e)},ze=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,Ce)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?K(n):t.toasts.forEach(l=>{K(l.id)}),{...t,toasts:t.toasts.map(l=>l.id===n||n===void 0?{...l,open:!1}:l)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},L=[];let F={toasts:[]};function P(t){F=ze(F,t),L.forEach(e=>{e(F)})}function Le({...t}){const e=Be(),n=r=>P({type:"UPDATE_TOAST",toast:{...r,id:e}}),l=()=>P({type:"DISMISS_TOAST",toastId:e});return P({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:r=>{r||l()}}}),{id:e,dismiss:l,update:n}}function Fe(){const[t,e]=u.useState(F);return u.useEffect(()=>(L.push(e),()=>{const n=L.indexOf(e);n>-1&&L.splice(n,1)}),[t]),{...t,toast:Le,dismiss:n=>P({type:"DISMISS_TOAST",toastId:n})}}function I(...t){return le(de(t))}const Ve=ve,oe=u.forwardRef(({className:t,...e},n)=>i.jsx(W,{ref:n,className:I("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));oe.displayName=W.displayName;const Me=me("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),re=u.forwardRef(({className:t,variant:e,...n},l)=>i.jsx(Y,{ref:l,className:I(Me({variant:e}),t),...n}));re.displayName=Y.displayName;const Ue=u.forwardRef(({className:t,...e},n)=>i.jsx(H,{ref:n,className:I("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));Ue.displayName=H.displayName;const ne=u.forwardRef(({className:t,...e},n)=>i.jsx(J,{ref:n,className:I("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:i.jsx(ue,{className:"h-4 w-4"})}));ne.displayName=J.displayName;const se=u.forwardRef(({className:t,...e},n)=>i.jsx(Z,{ref:n,className:I("text-sm font-semibold",t),...e}));se.displayName=Z.displayName;const ie=u.forwardRef(({className:t,...e},n)=>i.jsx(ee,{ref:n,className:I("text-sm opacity-90",t),...e}));ie.displayName=ee.displayName;function $e(){const{toasts:t}=Fe();return i.jsxs(Ve,{children:[t.map(function({id:e,title:n,description:l,action:r,...m}){return i.jsxs(re,{...m,children:[i.jsxs("div",{className:"grid gap-1",children:[n&&i.jsx(se,{children:n}),l&&i.jsx(ie,{children:l})]}),r,i.jsx(ne,{})]},e)}),i.jsx(oe,{})]})}const qe=({...t})=>{const{theme:e="system"}=fe();return i.jsx(pe,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},Qe=Ee,Xe=u.forwardRef(({className:t,sideOffset:e=4,...n},l)=>i.jsx(te,{ref:l,sideOffset:e,className:I("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Xe.displayName=te.displayName;const Ge=u.lazy(()=>D(()=>import("./Index-DoFsyQdd.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),Ke=u.lazy(()=>D(()=>import("./Inscripcion-CCUjht9K.js"),__vite__mapDeps([10,1,2,3,4,9,11,12,6]))),We=u.lazy(()=>D(()=>import("./Reglamento-NVh1EWIl.js"),__vite__mapDeps([13,1,2,3,4,7,9]))),Ye=u.lazy(()=>D(()=>import("./Resultados-Cj4QiQ2v.js"),__vite__mapDeps([14,1,2,3,4,5,7,12,9]))),He=u.lazy(()=>D(()=>import("./Admin-CoeIwGEW.js"),__vite__mapDeps([15,1,2,3,4,5,11,12,9]))),Je=u.lazy(()=>D(()=>import("./NotFound-CkVNGuxK.js"),__vite__mapDeps([16,1,5,3,4,8,9]))),Ze=new ge,et=()=>i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background text-sm text-muted-foreground",children:"Cargando contenido..."}),tt=()=>{const t=ye();return u.useEffect(()=>{const e=sessionStorage.getItem("redirectPath");e&&(sessionStorage.removeItem("redirectPath"),t(e,{replace:!0}))},[t]),null},ot=()=>{const{pathname:t}=xe();return u.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[t]),null},rt=()=>i.jsx(he,{client:Ze,children:i.jsxs(Qe,{children:[i.jsx($e,{}),i.jsx(qe,{}),i.jsx(u.Suspense,{fallback:i.jsx(et,{}),children:i.jsxs(be,{basename:"/",children:[i.jsx(tt,{}),i.jsx(ot,{}),i.jsxs(we,{children:[i.jsx(j,{path:"/",element:i.jsx(Ge,{})}),i.jsx(j,{path:"/inscripcion",element:i.jsx(Ke,{})}),i.jsx(j,{path:"/reglamento",element:i.jsx(We,{})}),i.jsx(j,{path:"/resultados",element:i.jsx(Ye,{})}),i.jsx(j,{path:"/admin",element:i.jsx(He,{})}),i.jsx(j,{path:"*",element:i.jsx(Je,{})})]})]})})]})}),O=100,A="registrations",ae=u.createContext(void 0),nt=(t,e)=>{const n=e.createdAt;let l=new Date().toISOString();if(typeof n=="string")l=n;else if(n&&typeof n=="object"&&"toDate"in n)try{l=n.toDate().toISOString()}catch(r){console.warn("Failed to parse createdAt timestamp",r)}return{id:t,createdAt:l,dorsal:String(e.dorsal??""),status:e.status??"pending",nombre:String(e.nombre??""),dni:String(e.dni??""),nacimiento:String(e.nacimiento??""),email:String(e.email??""),telefono:String(e.telefono??""),club:String(e.club??""),distancia:String(e.distancia??""),sexo:String(e.sexo??""),categoria:String(e.categoria??""),emergenciaNombre:String(e.emergenciaNombre??""),emergenciaTel:String(e.emergenciaTel??""),medico:String(e.medico??""),banco:String(e.banco??""),monto:String(e.monto??""),referencia:String(e.referencia??""),tallaCamisa:String(e.tallaCamisa??""),comprobanteNombre:e.comprobanteNombre?String(e.comprobanteNombre):null,comprobanteUrl:e.comprobanteUrl?String(e.comprobanteUrl):null,comprobantePath:e.comprobantePath?String(e.comprobantePath):null,dniNormalized:e.dniNormalized?String(e.dniNormalized):null,checkedInAt:(()=>{const r=e.checkedInAt;if(!r)return null;if(typeof r=="string")return r;if(typeof r=="object"&&"toDate"in r)try{return r.toDate().toISOString()}catch(m){return console.warn("Failed to parse checkedInAt timestamp",m),null}return null})(),checkedInBy:e.checkedInBy?String(e.checkedInBy):null,resultTime:e.resultTime?String(e.resultTime):null,resultSeconds:typeof e.resultSeconds=="number"?Number(e.resultSeconds):null,resultRecordedAt:(()=>{const r=e.resultRecordedAt;if(!r)return null;if(typeof r=="string")return r;if(typeof r=="object"&&"toDate"in r)try{return r.toDate().toISOString()}catch(m){return console.warn("Failed to parse resultRecordedAt timestamp",m),null}return null})(),resultRecordedBy:e.resultRecordedBy?String(e.resultRecordedBy):null,updatedAt:(()=>{const r=e.updatedAt;if(!r)return null;if(typeof r=="string")return r;if(typeof r=="object"&&"toDate"in r)try{return r.toDate().toISOString()}catch(m){return console.warn("Failed to parse updatedAt timestamp",m),null}return null})(),updatedBy:e.updatedBy?String(e.updatedBy):null}},st=t=>{if(!t.length)return"001";const e=t.map(l=>parseInt(l.dorsal,10)).filter(l=>Number.isFinite(l)).sort((l,r)=>r-l)[0]??0,n=Math.min(e+1,O);return String(n).padStart(3,"0")},it=({children:t})=>{const[e,n]=u.useState([]),[l,r]=u.useState(!0),[m,g]=u.useState(null);u.useEffect(()=>{const c=M(B(T,A),Ne("createdAt","desc")),o=Te(c,h=>{const w=h.docs.map(f=>nt(f.id,f.data()));w.sort((f,d)=>{const a=parseInt(f.dorsal??"0",10),s=parseInt(d.dorsal??"0",10);return Number.isFinite(a)&&Number.isFinite(s)&&a!==s?a-s:new Date(f.createdAt).getTime()-new Date(d.createdAt).getTime()}),n(w),r(!1),g(null)},h=>{console.error("Error al obtener inscripciones",h),g("No se pudieron cargar las inscripciones."),r(!1)});return()=>o()},[]);const x=u.useCallback(async c=>{if(e.length>=O)throw new Error("No hay cupos disponibles");const o=c.dni.replace(/\D/g,"");if(o.length!==13)throw new Error("El DNI debe contener exactamente 13 dígitos sin guiones.");if(e.some(p=>p.dniNormalized?p.dniNormalized===o:p.dni.replace(/\D/g,"")===o))throw new Error("Este DNI ya tiene una inscripción registrada.");if(!(await q(M(B(T,A),X("dniNormalized","==",o),Q(1)))).empty)throw new Error("Este DNI ya tiene una inscripción registrada.");const f=st(e),d=Date.now();let a=null,s=null,b=null,y;try{c.comprobanteFile&&(b=c.comprobanteFile.name,a=`comprobantes/${f}-${d}-${b}`,y=Ae(Re,a),await Ie(y,c.comprobanteFile),s=await je(y));const p={nombre:c.nombre,dni:o,dniNormalized:o,nacimiento:c.nacimiento,email:c.email,telefono:c.telefono,club:c.club,distancia:c.distancia,sexo:c.sexo,categoria:c.categoria,emergenciaNombre:c.emergenciaNombre,emergenciaTel:c.emergenciaTel,medico:c.medico,banco:c.banco,monto:c.monto,referencia:c.referencia,tallaCamisa:c.tallaCamisa,comprobanteNombre:b,comprobanteUrl:s,comprobantePath:a,checkedInAt:null,checkedInBy:null,dorsal:f,status:"pending",createdAt:N(),resultTime:null,resultSeconds:null,resultRecordedAt:null,resultRecordedBy:null,updatedAt:N(),updatedBy:null};return{id:(await De(B(T,A),p)).id,...p,createdAt:new Date().toISOString()}}catch(p){if(y)try{await _e(y)}catch(E){console.warn("No se pudo limpiar el comprobante subido",E)}throw p}},[e]),S=u.useCallback(async(c,o,h,w={})=>{const f=z(T,A,c);await _(f,{status:o,...w,updatedAt:N(),updatedBy:h})},[]),R=u.useCallback(async(c,o,h)=>{const w=z(T,A,c);o?await _(w,{checkedInAt:N(),checkedInBy:h,updatedAt:N(),updatedBy:h}):await _(w,{checkedInAt:null,checkedInBy:null,updatedAt:N(),updatedBy:h})},[]),C=u.useCallback(async(c,o,h)=>{const w=z(T,A,c);let f=null,d=null;if(o){const a=o.trim().toUpperCase();if(["NT","NS","DNS","DNF"].includes(a))d=a,f=null;else{const b=a.split(":").map(p=>p.trim());if(b.some(p=>p===""||Number.isNaN(Number(p))))throw new Error("Formato de tiempo inválido. Usa mm:ss, hh:mm:ss o los valores NT/NS.");const y=b.map(p=>Number(p));if(y.length===2){const[p,E]=y;f=p*60+E}else if(y.length===3){const[p,E,ce]=y;f=p*3600+E*60+ce}else throw new Error("Formato de tiempo inválido. Usa mm:ss, hh:mm:ss o los valores NT/NS.");if(!Number.isFinite(f)||f<0)throw new Error("El tiempo debe ser un número positivo.");d=b.join(":")}}else d=null;await _(w,{resultTime:d,resultSeconds:f,resultRecordedAt:o?N():null,resultRecordedBy:o?h:null,updatedAt:N(),updatedBy:h})},[]),v=u.useCallback(async(c,o,h)=>{const w=z(T,A,c),f=e.find(s=>s.id===c);if(!f)throw new Error("No se encontró el registro que intentas editar.");const d={},a=s=>typeof s=="string"?s.trim():void 0;if("nombre"in o){const s=a(o.nombre);if(!s)throw new Error("El nombre es obligatorio.");d.nombre=s}if("email"in o){const s=a(o.email);if(!s)throw new Error("El correo electrónico es obligatorio.");d.email=s}if("telefono"in o){const s=a(o.telefono);if(!s)throw new Error("El teléfono es obligatorio.");d.telefono=s}if("club"in o){const s=a(o.club);d.club=s??""}if("emergenciaNombre"in o&&(d.emergenciaNombre=a(o.emergenciaNombre)??""),"emergenciaTel"in o&&(d.emergenciaTel=a(o.emergenciaTel)??""),"medico"in o&&(d.medico=a(o.medico)??""),"banco"in o){const s=a(o.banco);if(!s)throw new Error("El banco o plataforma es obligatorio.");d.banco=s}if("monto"in o){const s=a(o.monto);if(!s)throw new Error("El monto es obligatorio.");d.monto=s}if("referencia"in o){const s=a(o.referencia);if(!s)throw new Error("La referencia o comprobante es obligatoria.");d.referencia=s}if("tallaCamisa"in o&&(d.tallaCamisa=a(o.tallaCamisa)??""),"dorsal"in o){const s=a(o.dorsal);if(!s)throw new Error("El dorsal es obligatorio.");const b=s.replace(/\D/g,"");if(!b)throw new Error("El dorsal debe ser numérico.");const y=b.padStart(3,"0");if(e.some(E=>E.id!==c&&E.dorsal===y))throw new Error("Este dorsal ya está asignado a otro participante.");d.dorsal=y}if("sexo"in o){const s=a(o.sexo);if(!s||!["M","F"].includes(s))throw new Error("Selecciona un sexo válido.");d.sexo=s}if("distancia"in o){const s=a(o.distancia);if(!s||!["800m","2km","5km"].includes(s))throw new Error("Selecciona una distancia válida.");d.distancia=s}if("categoria"in o&&(d.categoria=a(o.categoria)??""),"nacimiento"in o){const s=a(o.nacimiento);if(!s)throw new Error("La fecha de nacimiento es obligatoria.");d.nacimiento=s}if("dni"in o){const s=a(o.dni);if(!s)throw new Error("El DNI es obligatorio.");const b=s.replace(/\D/g,"");if(b.length!==13)throw new Error("El DNI debe contener exactamente 13 dígitos sin guiones.");if(b!==f.dniNormalized&&(await q(M(B(T,A),X("dniNormalized","==",b),Q(1)))).docs.some(E=>E.id!==c))throw new Error("Este DNI ya tiene una inscripción registrada.");d.dni=b,d.dniNormalized=b}Object.keys(d).length!==0&&await _(w,{...d,updatedAt:N(),updatedBy:h})},[e]),k=u.useMemo(()=>{const c=e.length,o=e.filter(a=>a.status==="pending").length,h=e.filter(a=>a.status==="validated").length,w=e.filter(a=>a.status==="rejected").length,f=e.filter(a=>a.checkedInAt!==null).length,d=Math.max(O-c,0);return{total:c,pending:o,validated:h,rejected:w,remaining:d,max:O,capacityFull:c>=O,checkedIn:f}},[e]),V=u.useMemo(()=>({registrations:e,stats:k,isLoading:l,error:m,addRegistration:x,updateRegistrationStatus:S,toggleCheckIn:R,updateRegistrationResult:C,updateRegistrationData:v}),[e,k,l,m,x,S,R,C,v]);return i.jsx(ae.Provider,{value:V,children:t})},dt=()=>{const t=u.useContext(ae);if(!t)throw new Error("useRegistrations debe usarse dentro de RegistrationProvider");return t};Se(document.getElementById("root")).render(i.jsx(it,{children:i.jsx(rt,{})}));export{Fe as a,I as c,dt as u};
